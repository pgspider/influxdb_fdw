SET datestyle=ISO;
-- timestamp with time zone differs based on this
SET timezone='UTC';
\set ECHO none
-- Init data original
:INIT_TAG_ORIGINAL;
-- Before update data
-- Testcase 1:
CREATE EXTENSION influxdb_fdw CASCADE;
--Testcase 2:
CREATE SERVER influxdb_svr FOREIGN DATA WRAPPER influxdb_fdw OPTIONS (dbname 'schemalessdb', :SERVER);
--Testcase 3:
CREATE USER MAPPING FOR CURRENT_USER SERVER influxdb_svr OPTIONS (:AUTHENTICATION);
--Testcase 4:
CREATE FOREIGN TABLE sctbl9 (tags jsonb OPTIONS(tags 'true'), fields jsonb OPTIONS(fields 'true'), time timestamp) SERVER influxdb_svr OPTIONS (schemaless 'true', tags 'sid, sname');
--Testcase 5:
CREATE FOREIGN TABLE sctbl4 (fields jsonb OPTIONS(fields 'true'), time timestamp) SERVER influxdb_svr OPTIONS (schemaless 'true');
--------------------------------------------------------------------------------------- TC for before update test data -------------------------------------------------------------------------------------------------
--Testcase 6:
select * from sctbl4;
                                       fields                                       |        time         
------------------------------------------------------------------------------------+---------------------
 {"sig1": "-340", "sig2": "装置開発機能仕", "sig3": "0", "sig4": "true"}            | 1970-01-01 00:02:22
 {"sig1": "9260", "sig2": "設計 検討資料", "sig3": "206", "sig4": "false"}          | 1970-01-01 01:38:47
 {"sig1": "480", "sig2": "+!2-3-12030_!@#!)~_#@%)", "sig3": "308", "sig4": "false"} | 1970-01-01 02:24:38
 {"sig1": "12120", "sig2": "aoao wejf", "sig3": "-101", "sig4": "true"}             | 1970-01-01 06:30:42
 {"sig1": "370", "sig2": "g029012", "sig3": "307", "sig4": "true"}                  | 1970-01-01 11:45:51
 {"sig1": "1250", "sig2": "システム", "sig3": "205", "sig4": "false"}               | 1970-01-01 15:10:28
 {"sig1": "190", "sig2": "012002'akewo02", "sig3": "309", "sig4": "false"}          | 1970-01-02 03:22:22
 {"sig1": "2120", "sig2": "BAEFOAWJ#AWEK", "sig3": "102", "sig4": "false"}          | 1970-01-08 07:33:03
 {"sig1": "-230", "sig2": "C)@maEFJAe=3kake", "sig3": "103", "sig4": "false"}       | 1970-10-28 16:19:12
(9 rows)

--Testcase 7:
select time, (fields->>'sig1')::bigint sig1, fields->>'sig2' sig2, (fields->>'sig3')::double precision sig3, (fields->>'sig4')::boolean sig4 from sctbl4;
        time         | sig1  |          sig2           | sig3 | sig4 
---------------------+-------+-------------------------+------+------
 1970-01-01 00:02:22 |  -340 | 装置開発機能仕          |    0 | t
 1970-01-01 01:38:47 |  9260 | 設計 検討資料           |  206 | f
 1970-01-01 02:24:38 |   480 | +!2-3-12030_!@#!)~_#@%) |  308 | f
 1970-01-01 06:30:42 | 12120 | aoao wejf               | -101 | t
 1970-01-01 11:45:51 |   370 | g029012                 |  307 | t
 1970-01-01 15:10:28 |  1250 | システム                |  205 | f
 1970-01-02 03:22:22 |   190 | 012002'akewo02          |  309 | f
 1970-01-08 07:33:03 |  2120 | BAEFOAWJ#AWEK           |  102 | f
 1970-10-28 16:19:12 |  -230 | C)@maEFJAe=3kake        |  103 | f
(9 rows)

--Testcase 8:
select max(fields->>'sig2'), min(time), bool_or(fields->>'sig2' != 'JAPA') from sctbl4;
      max      |         min         | bool_or 
---------------+---------------------+---------
 設計 検討資料 | 1970-01-01 00:02:22 | t
(1 row)

--Testcase 9:
select bool_and((fields->>'sig3')::double precision > -10), string_agg('446757svbvskkk', fields->>'sig2'), avg ((fields->>'sig1')::bigint) from sctbl4;
 bool_and |                                                                                                              string_agg                                                                                                               |          avg          
----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------
 f        | 446757svbvskkk設計 検討資料446757svbvskkk+!2-3-12030_!@#!)~_#@%)446757svbvskkkaoao wejf446757svbvskkkg029012446757svbvskkkシステム446757svbvskkk012002'akewo02446757svbvskkkBAEFOAWJ#AWEK446757svbvskkkC)@maEFJAe=3kake446757svbvskkk | 2802.2222222222222222
(1 row)

--Testcase 10:
select count(fields->>'sig1'), stddev((fields->>'sig3')::double precision + 333), min(fields->>'sig2' COLLATE "en_US") from sctbl4;
 count |       stddev       |      min       
-------+--------------------+----------------
     9 | 145.85476033064916 | 012002'akewo02
(1 row)

--Testcase 11:
select bool_or((fields->>'sig1')::bigint >= 1234), stddev((fields->>'sig1')::bigint), stddev((fields->>'sig3')::double precision) from sctbl4;
 bool_or |      stddev       |       stddev       
---------+-------------------+--------------------
 t       | 4590.734630148474 | 145.85476033064916
(1 row)

--------------------------------------------------------------------------------------- Update: Add 1 tag --------------------------------------------------------------------------------------------------------------
-- Update data : add 1 tag
:RECOVER_INIT_TAG_ADD_1;
--Testcase 12:
DROP FOREIGN TABLE sctbl4;
--Testcase 13:
CREATE FOREIGN TABLE sctbl4 (tags jsonb OPTIONS(tags 'true'), fields jsonb OPTIONS(fields 'true'), time timestamp) SERVER influxdb_svr OPTIONS (schemaless 'true', tags 'sid');
-- Select all data with aggregate
--Testcase 14:
select avg((fields->>'sig3')::double precision), bool_and(fields->>'sig2' != '%a%'), count(*) from sctbl4 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
        avg         | bool_and | count 
--------------------+----------+-------
         2516968931 | t        |     3
          566298823 | t        |     2
                -12 | t        |     2
       4917871303.5 | t        |     2
 159.88888888888889 | t        |     9
(5 rows)

--Testcase 15:
select bool_or((fields->>'sig1')::bigint >= 1234), stddev((fields->>'sig1')::bigint), avg((fields->>'sig3')::double precision) from sctbl4 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
 bool_or |      stddev       |        avg         
---------+-------------------+--------------------
 t       | 6603.097757870922 |         2516968931
 t       | 1237.436867076458 |          566298823
 t       | 6710.443353460336 |                -12
 f       |  579.827560572969 |       4917871303.5
 t       | 4590.734630148474 | 159.88888888888889
(5 rows)

--Testcase 16:
select max(time), avg((fields->>'sig3')::double precision), sum((fields->>'sig1')::bigint) from sctbl4 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
         max         |        avg         |  sum  
---------------------+--------------------+-------
 1970-01-01 02:22:58 |         2516968931 | 13560
 1970-01-07 01:54:05 |          566298823 |  2490
 1970-01-01 12:05:46 |                -12 |  9030
 1970-01-01 14:36:06 |       4917871303.5 |   140
 1970-10-28 16:19:12 | 159.88888888888889 | 25220
(5 rows)

--Testcase 17:
select string_agg(fields->>'sig2', 'ASDFG!@#$%zxc'), count(time), avg((fields->>'sig1')::bigint) from sctbl4 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
                                                                                                          string_agg                                                                                                           | count |          avg          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------+-----------------------
 012002'akewo02ASDFG!@#$%zxcaoaowejfASDFG!@#$%zxcシステムGUIソフトウエア                                                                                                                                                       |     3 | 4520.0000000000000000
 g029012ASDFG!@#$%zxcBAEFOAWJ#AWEK                                                                                                                                                                                             |     2 | 1245.0000000000000000
 インターフェース設計検討資料ASDFG!@#$%zxcC)@maEFJAe=3kake                                                                                                                                                                     |     2 | 4515.0000000000000000
 +!2-3-12030_!@#!)~_#@%)ASDFG!@#$%zxc装置開発機能仕                                                                                                                                                                            |     2 |   70.0000000000000000
 装置開発機能仕ASDFG!@#$%zxc設計 検討資料ASDFG!@#$%zxc+!2-3-12030_!@#!)~_#@%)ASDFG!@#$%zxcaoao wejfASDFG!@#$%zxcg029012ASDFG!@#$%zxcシステムASDFG!@#$%zxc012002'akewo02ASDFG!@#$%zxcBAEFOAWJ#AWEKASDFG!@#$%zxcC)@maEFJAe=3kake |     9 | 2802.2222222222222222
(5 rows)

--Testcase 18:
select sum((fields->>'sig3')::double precision), stddev((fields->>'sig3')::double precision), min((fields->>'sig1')::bigint) from sctbl4 GROUP BY tags->>'sid' ORDER BY 1, 2, 3;
    sum     |       stddev       | min  
------------+--------------------+------
        -24 |  16.97056274847714 | -230
       1439 | 145.85476033064916 | -340
 1132597646 |  646026566.5016799 |  370
 7550906793 | 2203533896.7414036 |  190
 9835742607 |   6941647940.73026 | -340
(5 rows)

-- Select aggregate contain expression
--Testcase 19:
select bool_or(((fields->>'sig1')::bigint + (fields->>'sig3')::double precision - 9999) > 0), stddev((fields->>'sig3')::double precision / (fields->>'sig1')::bigint + 3291), stddev((fields->>'sig3')::double precision * 12.3 - (fields->>'sig1')::bigint) from sctbl4 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
 bool_or |        stddev         |      stddev       
---------+-----------------------+-------------------
 t       |    10395428.649287097 | 27103463254.84223
 t       |     132004.1228102828 | 7946125530.533796
 f       | 0.0018326741624507942 | 6919.181275266606
 t       |    14495110.081305722 | 85382269091.15465
 t       |    0.6181047995469497 |  5676.87270740776
(5 rows)

--Testcase 20:
select avg((fields->>'sig3')::double precision * (fields->>'sig1')::bigint / 34241), bool_and(fields->>'sig2' != '%c'), bool_and((fields->>'sig4')::boolean AND true OR true) from sctbl4 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
         avg         | bool_and | bool_and 
---------------------+----------+----------
   489923530.0587015 | t        | t
  32263969.506877717 | t        | t
 -3.2452323238223184 | t        | t
   68827732.45991647 | t        | t
   4.712933487794035 | t        | t
(5 rows)

--Testcase 21:
select sum((fields->>'sig3')::double precision * 123.456 + (fields->>'sig1')::bigint), bool_and((fields->>'sig4')::boolean OR false), bool_or((fields->>'sig4')::boolean AND true AND true) from sctbl4 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
        sum         | bool_and | bool_or 
--------------------+----------+---------
   932204762596.608 | f        | t
   139825977474.576 | f        | t
 6067.0560000000005 | f        | f
  1214281439429.792 | f        | t
         202873.184 | f        | t
(5 rows)

--Testcase 22:
select min((fields->>'sig3')::double precision / ((fields->>'sig3')::double precision + 223344)), max((fields->>'sig1')::bigint * (fields->>'sig3')::double precision - (fields->>'sig3')::double precision), count(*) from sctbl4 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
           min           |      max       | count 
-------------------------+----------------+-------
    -0.04687265636718164 | 49666316485165 |     3
      0.9979642775295748 |  2167967100091 |     2
 -0.00010746910263299302 |             -0 |     2
      0.9767551358635582 |  4706825307165 |     2
 -0.00045242180045958885 |        1907354 |     9
(5 rows)

--Testcase 23:
select every((fields->>'sig4')::boolean OR (fields->>'sig4')::boolean AND true), max (fields->>'sig2' || 'handsome' || 'ugly'), avg((fields->>'sig1')::bigint / (fields->>'sig1')::bigint + 9999.999) from sctbl4 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
 every |                   max                    |          avg           
-------+------------------------------------------+------------------------
 f     | システムGUIソフトウエアhandsomeugly      | 10000.9990000000000000
 f     | g029012handsomeugly                      | 10000.9990000000000000
 f     | インターフェース設計検討資料handsomeugly | 10000.9990000000000000
 f     | 装置開発機能仕handsomeugly               | 10000.9990000000000000
 f     | 設計 検討資料handsomeugly                | 10000.9990000000000000
(5 rows)

-- Select combine-aggregate
--Testcase 24:
select avg((fields->>'sig3')::double precision) + sum((fields->>'sig3')::double precision) / avg((fields->>'sig1')::bigint), bool_and(fields->>'sig2' != '%a%') AND bool_and((fields->>'sig4')::boolean AND true) AND true , max((fields->>'sig1')::bigint * (fields->>'sig1')::bigint / 0.0001) + min((fields->>'sig3')::double precision / ((fields->>'sig1')::bigint + 99999)) * sum((fields->>'sig1')::bigint * (fields->>'sig1')::bigint - (fields->>'sig3')::double precision) from sctbl4 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
      ?column?      | ?column? |      ?column?       
--------------------+----------+---------------------
  2518639485.600221 | f        |  1469675109817.6772
   567208539.984739 | f        | -1185515320619.6707
 -12.00531561461794 | f        |   857475981152.9249
  5058381912.171429 | f        |  -923903585522.5319
 160.40240990395628 | f        |  1468943784459.3203
(5 rows)

--Testcase 25:
select stddev((fields->>'sig3')::double precision * 0.0001 - (fields->>'sig1')::bigint) + min((fields->>'sig3')::double precision / ((fields->>'sig1')::bigint + 3.344)) * stddev((fields->>'sig1')::bigint * (fields->>'sig1')::bigint - (fields->>'sig3')::double precision), bool_or((fields->>'sig3')::double precision / (fields->>'sig1')::bigint < -10) OR bool_or((fields->>'sig4')::boolean OR true OR false) AND bool_and(fields->>'sig2' != '%c'), string_agg(fields->>'sig2', '恨挫') from sctbl4 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
      ?column?       | ?column? |                                                                      string_agg                                                                       
---------------------+----------+-------------------------------------------------------------------------------------------------------------------------------------------------------
 -17175771729.897675 | t        | 012002'akewo02恨挫aoaowejf恨挫システムGUIソフトウエア
  188553934054511.12 | t        | g029012恨挫BAEFOAWJ#AWEK
 -150283.36742750753 | t        | インターフェース設計検討資料恨挫C)@maEFJAe=3kake
  -193510317626754.6 | t        | +!2-3-12030_!@#!)~_#@%)恨挫装置開発機能仕
 -24144718.959654775 | t        | 装置開発機能仕恨挫設計 検討資料恨挫+!2-3-12030_!@#!)~_#@%)恨挫aoao wejf恨挫g029012恨挫システム恨挫012002'akewo02恨挫BAEFOAWJ#AWEK恨挫C)@maEFJAe=3kake
(5 rows)

--Testcase 26:
select max((fields->>'sig1')::bigint) * max((fields->>'sig3')::double precision) + sum((fields->>'sig1')::bigint), stddev((fields->>'sig1')::bigint) * avg((fields->>'sig3')::double precision) / avg((fields->>'sig1')::bigint), sum((fields->>'sig3')::double precision) + stddev((fields->>'sig3')::double precision) - count((fields->>'sig4')::boolean) from sctbl4 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
    ?column?    |      ?column?       |      ?column?      
----------------+---------------------+--------------------
 49670414717760 |  3676945111.7072725 |  9754440686.741404
  2168990211170 |   562858667.7608076 |   1778624210.50168
           9030 | -17.835065391256705 | -9.029437251522861
  4716651664940 |   40735961730.28875 | 16777390545.730259
        3770300 |   261.9376341309934 | 1575.8547603306492
(5 rows)

--Testcase 27:
select count(fields->>'sig2') * count(fields->>'sig4') / min((fields->>'sig1')::bigint), stddev((fields->>'sig1')::bigint) - count(fields->>'sig2') * sum((fields->>'sig1')::bigint), avg((fields->>'sig3')::double precision) - avg((fields->>'sig1')::bigint) * sum((fields->>'sig1')::bigint) from sctbl4 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
 ?column? |       ?column?       |      ?column?      
----------+----------------------+--------------------
        0 |  -34076.902242129078 |         2455677731
        0 |   -3742.563132923542 |          563198773
        0 |  -11349.556646539664 |          -40770462
        0 |     299.827560572969 |       4917861503.5
        0 | -222389.265369851526 | -70671884.55555555
(5 rows)

-- Select with WHERE multi-condition
--Testcase 28:
select max(fields->>'sig2'), sum((fields->>'sig3')::double precision), bool_or(fields->>'sig2' != 'viEtnAM') from sctbl4 WHERE (fields->>'sig1')::bigint > 0 AND (fields->>'sig4')::boolean = true OR fields->>'sig2' LIKE '%a%' GROUP BY tags->>'sid' ORDER BY tags->>'sid';
       max        |    sum     | bool_or 
------------------+------------+---------
 aoaowejf         | 7550916793 | t
 g029012          |  109489057 | t
 C)@maEFJAe=3kake |          0 | t
 g029012          |        618 | t
(4 rows)

--Testcase 29:
select bool_and((fields->>'sig3')::double precision >= 1.6789), string_agg('ったのか誰も質問しま', fields->>'sig2'), avg ((fields->>'sig1')::bigint) from sctbl4 WHERE (fields->>'sig3')::double precision = 0 AND fields->>'sig2' IN ('%開発%', '%b%') OR ((fields->>'sig3')::double precision / (fields->>'sig1')::bigint) <= 6.1234 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
 bool_and |                                                                                                                                         string_agg                                                                                                                                          |          avg          
----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------
 f        | ったのか誰も質問しま                                                                                                                                                                                                                                                                        | 1250.0000000000000000
 f        | ったのか誰も質問しまC)@maEFJAe=3kakeったのか誰も質問しま                                                                                                                                                                                                                                    | 4515.0000000000000000
 t        | ったのか誰も質問しま                                                                                                                                                                                                                                                                        | -340.0000000000000000
 f        | ったのか誰も質問しま設計 検討資料ったのか誰も質問しま+!2-3-12030_!@#!)~_#@%)ったのか誰も質問しまaoao wejfったのか誰も質問しまg029012ったのか誰も質問しまシステムったのか誰も質問しま012002'akewo02ったのか誰も質問しまBAEFOAWJ#AWEKったのか誰も質問しまC)@maEFJAe=3kakeったのか誰も質問しま | 2802.2222222222222222
(4 rows)

--Testcase 30:
select avg((fields->>'sig3')::double precision), count(*), count(fields->>'sig2') from sctbl4 WHERE (fields->>'sig4')::boolean = true OR time = '2020-01-09 01:00:00+00' AND (fields->>'sig3')::double precision != 0 GROUP BY tags->>'sid' ORDER BY tags->>'sid';
        avg        | count | count 
-------------------+-------+-------
        4098219035 |     1 |     1
         109489057 |     1 |     1
           9384972 |     1 |     1
 68.66666666666667 |     3 |     3
(4 rows)

--Testcase 31:
select string_agg(fields->>'sig2', fields->>'sig2'), min(time), max(time) from sctbl4 WHERE (fields->>'sig4')::boolean = false OR (fields->>'sig4')::boolean = true AND time < '2000-01-01 23:00:00+00' GROUP BY tags->>'sid' ORDER BY tags->>'sid';
                                                                                                          string_agg                                                                                                          |         min         |         max         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+---------------------
 012002'akewo02aoaowejfaoaowejfシステムGUIソフトウエアシステムGUIソフトウエア                                                                                                                                                 | 1970-01-01 00:40:25 | 1970-01-01 02:22:58
 g029012BAEFOAWJ#AWEKBAEFOAWJ#AWEK                                                                                                                                                                                            | 1970-01-01 00:01:39 | 1970-01-07 01:54:05
 インターフェース設計検討資料C)@maEFJAe=3kakeC)@maEFJAe=3kake                                                                                                                                                                 | 1970-01-01 00:16:26 | 1970-01-01 12:05:46
 +!2-3-12030_!@#!)~_#@%)装置開発機能仕装置開発機能仕                                                                                                                                                                          | 1970-01-01 03:27:11 | 1970-01-01 14:36:06
 装置開発機能仕設計 検討資料設計 検討資料+!2-3-12030_!@#!)~_#@%)+!2-3-12030_!@#!)~_#@%)aoao wejfaoao wejfg029012g029012システムシステム012002'akewo02012002'akewo02BAEFOAWJ#AWEKBAEFOAWJ#AWEKC)@maEFJAe=3kakeC)@maEFJAe=3kake | 1970-01-01 00:02:22 | 1970-10-28 16:19:12
(5 rows)

--Testcase 32:
select count(fields->>'sig4'), every((fields->>'sig3')::double precision < 0), stddev((fields->>'sig3')::double precision) from sctbl4 WHERE (fields->>'sig4')::boolean <> true AND fields->>'sig2' ILIKE 'ターフェー' OR fields->>'sig2' LIKE 'akewo0' GROUP BY tags->>'sid' ORDER BY tags->>'sid';
 count | every | stddev 
-------+-------+--------
(0 rows)

-- Select with HAVING LIMIT OFFSET
--Testcase 33:
select sum((fields->>'sig1')::bigint + (fields->>'sig1')::bigint * (fields->>'sig3')::double precision), string_agg(fields->>'sig2', fields->>'sig2'), string_agg(fields->>'sig2' || 'vjbkvba', 'も質問' || (fields->>'sig2')::text) from sctbl4 WHERE fields->>'sig2' LIKE '%a%' OR (fields->>'sig1')::bigint > 0 GROUP BY tags->>'sid',(fields->>'sig3')::double precision HAVING (fields->>'sig3')::double precision > 0 ORDER BY tags->>'sid' LIMIT 5 OFFSET 0;
      sum       |       string_agg        |           string_agg           
----------------+-------------------------+--------------------------------
   656012574210 | 012002'akewo02          | 012002'akewo02vjbkvba
 49670414716320 | aoaowejf                | aoaowejfvjbkvba
    40510951460 | g029012                 | g029012vjbkvba
  2168990210800 | BAEFOAWJ#AWEK           | BAEFOAWJ#AWEKvjbkvba
  4716651665280 | +!2-3-12030_!@#!)~_#@%) | +!2-3-12030_!@#!)~_#@%)vjbkvba
(5 rows)

--Testcase 34:
select string_agg(fields->>'sig2' || (fields->>'sig2')::text, fields->>'sig2' || '!@#$%^&*'), every((fields->>'sig4')::boolean OR true AND false), stddev((fields->>'sig3')::double precision - (fields->>'sig1')::bigint / (fields->>'sig1')::bigint) from sctbl4 WHERE (fields->>'sig3')::double precision <= 999999999 GROUP BY tags->>'sid',fields->>'sig4' HAVING (fields->>'sig4')::boolean <> false ORDER BY tags->>'sid' LIMIT 5 OFFSET 1;
                                          string_agg                                          | every |      stddev       
----------------------------------------------------------------------------------------------+-------+-------------------
 装置開発機能仕装置開発機能仕                                                                 | t     |                  
 装置開発機能仕装置開発機能仕aoao wejf!@#$%^&*aoao wejfaoao wejfg029012!@#$%^&*g029012g029012 | t     | 212.4907841138842
(2 rows)

--Testcase 35:
select stddev((fields->>'sig3')::double precision * 0.416754 + (fields->>'sig1')::bigint), min((fields->>'sig3')::double precision / ((fields->>'sig1')::bigint + 3.344)), stddev((fields->>'sig1')::bigint * (fields->>'sig1')::bigint - (fields->>'sig3')::double precision) from sctbl4 WHERE (fields->>'sig1')::bigint >= -1555.555 GROUP BY tags->>'sid',fields->>'sig4' HAVING (fields->>'sig4')::boolean <> true ORDER BY tags->>'sid' LIMIT 5 OFFSET 1;
       stddev       |          min           |       stddev       
--------------------+------------------------+--------------------
                    |     481838.35921075434 |                   
  6703.370803552657 | -0.0025908570382358683 | 60595320.452309586
                    |      20329946.44600947 |                   
 3565.3317769147857 |    -0.4544331497952845 |  34527904.96478543
(4 rows)

--Testcase 36:
select bool_or((fields->>'sig3')::double precision / (fields->>'sig1')::bigint >= 15.5678), max ((fields->>'sig3')::double precision / (fields->>'sig1')::bigint * (fields->>'sig1')::bigint), every(((fields->>'sig3')::double precision - (fields->>'sig1')::bigint) < 0) from sctbl4 WHERE (fields->>'sig4')::boolean <> false GROUP BY tags->>'sid',fields->>'sig4' HAVING (fields->>'sig4')::boolean = true ORDER BY tags->>'sid' LIMIT 5 OFFSET 2;
 bool_or |   max   | every 
---------+---------+-------
 f       | 9384972 | f
 f       |     307 | f
(2 rows)

--Testcase 37:
select max (fields->>'sig2' || 'kethattinh' || 'hanoilanhqua'), sum ((fields->>'sig3')::double precision - (fields->>'sig3')::double precision - (fields->>'sig1')::bigint), avg((fields->>'sig1')::bigint + (fields->>'sig1')::bigint + (fields->>'sig3')::double precision) from sctbl4 WHERE (fields->>'sig1')::bigint <= 10000000 GROUP BY tags->>'sid',(fields->>'sig2' COLLATE "en_US"),fields->>'sig4' HAVING (fields->>'sig2' COLLATE "en_US") IN ('%c%', '%1%') OR (fields->>'sig2' COLLATE "en_US") LIKE '%a%' ORDER BY tags->>'sid' LIMIT 5 OFFSET 2;
                  max                   |  sum   |  avg  
----------------------------------------+--------+-------
 C)@maEFJAe=3kakekethattinhhanoilanhqua |    230 |  -460
 012002'akewo02kethattinhhanoilanhqua   |   -190 |   689
 aoao wejfkethattinhhanoilanhqua        | -12120 | 24139
 C)@maEFJAe=3kakekethattinhhanoilanhqua |    230 |  -357
(4 rows)

-- Select with subquery
--Testcase 38:
select time, tags->>'sname' sname, (fields->>'sig1')::bigint sig1, fields->>'sig2' sig2, (fields->>'sig3')::double precision sig3, (fields->>'sig4')::boolean sig4 from (select * from sctbl9 ORDER BY tags->>'sid') AS sctbl9;
        time         |   sname   | sig1  |               sig2               | sig3 | sig4 
---------------------+-----------+-------+----------------------------------+------+------
 1970-01-01 00:00:00 | rapviet   | 12120 | 制御装置が正常に稼働していません | 10.1 | t
 1970-01-01 00:00:00 | kingofrap |  2120 | BAEFOAWJ#AWEK                    | 10.2 | f
 1970-01-01 00:00:00 | rapviet   |  -230 | C)@ma EFJAe=3kake                | 10.3 | f
 1970-01-01 00:00:01 | kingofrap |  -340 | 装置開111発機能仕                | 20.4 | t
 1970-01-01 00:00:01 | kingofrap |  1250 | システム                         | 20.5 | f
 1970-01-01 00:00:01 | rapviet   |  9260 | 設計検討資料                     | 20.6 | f
 1970-01-01 00:00:02 | rapviet   |   370 | XINChaoTOIyeUcaCbaN              | 30.7 | t
 1970-01-01 00:00:02 | kingofrap |   480 | +!2-3-12030_!@#!)~_#@%)          | 30.8 | f
 1970-01-01 00:00:02 | kingofrap |   190 | 0113 113'JXJOo02                 | 30.9 | f
(9 rows)

--Testcase 39:
select time, max(sig1), avg(sig3) from (select time, tags->>'sname' sname, ((fields->>'sig1')::bigint) sig1, fields->>'sig2' sig2, ((fields->>'sig3')::double precision) sig3, (fields->>'sig4')::boolean sig4 from sctbl9 GROUP BY time,tags->>'sname',fields->>'sig1',fields->>'sig2',fields->>'sig3',fields->>'sig4' ORDER BY 1,2,3,4,5,6) AS sctbl9 GROUP BY time;
        time         |  max  |        avg         
---------------------+-------+--------------------
 1970-01-01 00:00:00 | 12120 | 10.200000000000001
 1970-01-01 00:00:01 |  9260 |               20.5
 1970-01-01 00:00:02 |   480 |               30.8
(3 rows)

--Testcase 40:
select sum(sig3::double precision), string_agg(sig2, sname), count(sid) from (select time, tags->>'sid' sid, tags->>'sname' sname, (fields->>'sig1')::bigint sig1, fields->>'sig2' sig2, (fields->>'sig3')::double precision sig3, (fields->>'sig4')::boolean sig4 from sctbl9 ORDER BY tags->>'sid') AS sctbl9;
  sum  |                                                                                                           string_agg                                                                                                            | count 
-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------
 184.5 | 制御装置が正常に稼働していませんkingofrapBAEFOAWJ#AWEKrapvietC)@ma EFJAe=3kakekingofrap装置開111発機能仕kingofrapシステムrapviet設計検討資料rapvietXINChaoTOIyeUcaCbaNkingofrap+!2-3-12030_!@#!)~_#@%)kingofrap0113 113'JXJOo02 |     9
(1 row)

--------------------------------------------------------------------------------------- Update: Add 20 tag --------------------------------------------------------------------------------------------------------------
-- Update data : add 1 tag
:RECOVER_INIT_TAG_ADD_20;
--Testcase 41:
DROP FOREIGN TABLE sctbl4;
--Testcase 42:
CREATE FOREIGN TABLE sctbl4 (tags jsonb OPTIONS(tags 'true'), fields jsonb OPTIONS(fields 'true'), time timestamp) SERVER influxdb_svr OPTIONS (schemaless 'true', tags 'sid, sid1, sid2, sid3, sid4, sid5, sid6, sid7, sid8, sid9, sid10, sid11, sid12, sid13, sid14, sid15, sid16, sid17, sid18, sid19, sid20');
--Testcase 43:
select * from sctbl4;
                                                                                                                                                                                                                                      tags                                                                                                                                                                                                                                       |                                          fields                                           |        time         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------+---------------------
 {"sid": "id2", "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                               | {"sig1": "370", "sig2": "g029012", "sig3": "109489057", "sig4": "true"}                   | 1970-01-01 00:01:39
 {"sid": null, "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                                | {"sig1": "-340", "sig2": "装置開発機能仕", "sig3": "0", "sig4": "true"}                   | 1970-01-01 00:02:22
 {"sid": "id3", "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                               | {"sig1": "9260", "sig2": "インターフェース設計検討資料", "sig3": "-24", "sig4": "false"}  | 1970-01-01 00:16:26
 {"sid": "id1", "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                               | {"sig1": "190", "sig2": "012002'akewo02", "sig3": "3452697758", "sig4": "false"}          | 1970-01-01 00:40:25
 {"sid": "id1", "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                               | {"sig1": "12120", "sig2": "aoaowejf", "sig3": "4098219035", "sig4": "true"}               | 1970-01-01 01:27:15
 {"sid": null, "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                                | {"sig1": "9260", "sig2": "設計 検討資料", "sig3": "206", "sig4": "false"}                 | 1970-01-01 01:38:47
 {"sid": "id1", "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                               | {"sig1": "1250", "sig2": "システムGUIソフトウエア", "sig3": "-10000", "sig4": "false"}    | 1970-01-01 02:22:58
 {"sid": null, "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                                | {"sig1": "480", "sig2": "+!2-3-12030_!@#!)~_#@%)", "sig3": "308", "sig4": "false"}        | 1970-01-01 02:24:38
 {"sid": "id4", "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                               | {"sig1": "480", "sig2": "+!2-3-12030_!@#!)~_#@%)", "sig3": "9826357635", "sig4": "false"} | 1970-01-01 03:27:11
 {"sid": null, "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                                | {"sig1": "12120", "sig2": "aoao wejf", "sig3": "-101", "sig4": "true"}                    | 1970-01-01 06:30:42
 {"sid": null, "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                                | {"sig1": "370", "sig2": "g029012", "sig3": "307", "sig4": "true"}                         | 1970-01-01 11:45:51
 {"sid": "id3", "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                               | {"sig1": "-230", "sig2": "C)@maEFJAe=3kake", "sig3": "0", "sig4": "false"}                | 1970-01-01 12:05:46
 {"sid": "id4", "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                               | {"sig1": "-340", "sig2": "装置開発機能仕", "sig3": "9384972", "sig4": "true"}             | 1970-01-01 14:36:06
 {"sid": null, "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                                | {"sig1": "1250", "sig2": "システム", "sig3": "205", "sig4": "false"}                      | 1970-01-01 15:10:28
 {"sid": null, "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                                | {"sig1": "190", "sig2": "012002'akewo02", "sig3": "309", "sig4": "false"}                 | 1970-01-02 03:22:22
 {"sid": "id2", "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                               | {"sig1": "2120", "sig2": "BAEFOAWJ#AWEK", "sig3": "1023108589", "sig4": "false"}          | 1970-01-07 01:54:05
 {"sid": null, "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                                | {"sig1": "2120", "sig2": "BAEFOAWJ#AWEK", "sig3": "102", "sig4": "false"}                 | 1970-01-08 07:33:03
 {"sid": null, "sid1": "3W9awb6DnWDGOGr", "sid2": "4830959", "sid3": "0038", "sid4": "epzhtqukYCyZNZbI", "sid5": "FALSE", "sid6": "true", "sid7": "freighter", "sid8": "$%^&*", "sid9": "爱情不幸福", "sid10": "\"4 vợ 5 vợ 6 v\"", "sid11": "f", "sid12": "10781647619", "sid13": "4988.9871", "sid14": "id3", "sid15": "false", "sid16": "id3", "sid17": "当他等待淋浴温暖时，他注意到他能听到水的变化温度", "sid18": "id3", "sid19": "彼はなぜ18歳で彼が", "sid20": "31246"}  | {"sig1": "-230", "sig2": "C)@maEFJAe=3kake", "sig3": "10.3", "sig4": "false"}             | 1970-01-08 08:36:26
 {"sid": null, "sid1": "FaQLQ3WFGnMYWIe", "sid2": "5637128", "sid3": "7663", "sid4": "bafdZoYyqSgiklyQ", "sid5": "TRUE", "sid6": "false", "sid7": "average", "sid8": "&^%&^%$#", "sid9": "悲观失望希望美丽", "sid10": "\"3ck4\"", "sid11": "f", "sid12": "6146714", "sid13": "657898.01", "sid14": "id1", "sid15": "true", "sid16": "id1", "sid17": "生活中没有什么比一块馅饼好", "sid18": "id1", "sid19": "lを着た豚は誰も好きではない", "sid20": "8888888"}                    | {"sig1": "1250", "sig2": "システム", "sig3": "20.5", "sig4": "false"}                     | 1970-01-09 14:58:54
 {"sid": null, "sid1": "bNq9sRC3qfxY99a", "sid2": "5061715", "sid3": "8578", "sid4": "yZuKWGiQOFXDNAJm", "sid5": "TRUE", "sid6": "false", "sid7": "attract", "sid8": "$%^&*", "sid9": "辛辣仇恨挫败悲观情绪", "sid10": "\"1 vợ\"", "sid11": "t", "sid12": "13653", "sid13": "154581.27841", "sid14": "id1", "sid15": "true", "sid16": "id1", "sid17": "那就是他如何赢得100万美元", "sid18": "id1", "sid19": "彼は豚が", "sid20": "14681764"}                                     | {"sig1": "12120", "sig2": "aoaowejf", "sig3": "10.1", "sig4": "true"}                     | 1970-01-28 02:39:14
 {"sid": null, "sid1": "1wBi4XmD6vOCRM7", "sid2": "2462190", "sid3": "4366", "sid4": "SOlGbhjGOauCvZrK", "sid5": "FALSE", "sid6": "true", "sid7": "cooperation", "sid8": "@&*$%^&", "sid9": "生活无聊", "sid10": "\"1 chồng 2 ck \"", "sid11": "f", "sid12": "361645187500", "sid13": "178617.7", "sid14": "id4", "sid15": "false", "sid16": "id4", "sid17": "黎明起床是为了鸟", "sid18": "id4", "sid19": "彼はなぜ18歳で彼がHHJAHJGYJB", "sid20": "12315475"}                   | {"sig1": "-340", "sig2": "装置開発機能仕", "sig3": "20.4", "sig4": "true"}                | 1970-04-11 10:42:54
 {"sid": null, "sid1": "bMBOphOey0kXMun", "sid2": "9655923", "sid3": "3646", "sid4": "BOQGiWddylrRFmKs", "sid5": "FALSE", "sid6": "true", "sid7": "constraint", "sid8": "!@#$%^", "sid9": "讨厌生活", "sid10": "\"1 vợ 2 vợ 3 vợ\"", "sid11": "t", "sid12": "13167", "sid13": "9883.4341", "sid14": "id2", "sid15": "true", "sid16": "id2", "sid17": "明天将带来新的事物，所以今天就留下美好的回忆", "sid18": "id2", "sid19": "誰が作ったのか誰も質問しません", "sid20": "1232"} | {"sig1": "2120", "sig2": "BAEFOAWJ#AWEK", "sig3": "10.2", "sig4": "false"}                | 1970-06-14 12:42:25
 {"sid": null, "sid1": null, "sid2": null, "sid3": null, "sid4": null, "sid5": null, "sid6": null, "sid7": null, "sid8": null, "sid9": null, "sid10": null, "sid11": null, "sid12": null, "sid13": null, "sid14": null, "sid15": null, "sid16": null, "sid17": null, "sid18": null, "sid19": null, "sid20": null}                                                                                                                                                                | {"sig1": "-230", "sig2": "C)@maEFJAe=3kake", "sig3": "103", "sig4": "false"}              | 1970-10-28 16:19:12
(23 rows)

--Testcase 44:
select (fields->>'sig1')::bigint sig1, tags->>'sid1' sid1, (tags->>'sid2')::bigint sid2, (tags->>'sid3')::bigint sid3, tags->>'sid4' sid4, (tags->>'sid5')::boolean sid5, (tags->>'sid6')::boolean sid6, tags->>'sid7' sid7, tags->>'sid8' sid8, tags->>'sid9' sid9, tags->>'sid10' sid10, tags->>'sid11' sid11, (tags->>'sid12')::bigint sid12, (tags->>'sid13')::double precision sid13, tags->>'sid14' sid14, (tags->>'sid15')::boolean sid15, tags->>'sid16' sid16, tags->>'sid17' sid17, tags->>'sid18' sid18, tags->>'sid19' sid19, (tags->>'sid20')::bigint sid20 from sctbl4;
 sig1  |      sid1       |  sid2   | sid3 |       sid4       | sid5 | sid6 |    sid7     |   sid8   |         sid9         |      sid10       | sid11 |    sid12     |    sid13     | sid14 | sid15 | sid16 |                      sid17                       | sid18 |             sid19              |  sid20   
-------+-----------------+---------+------+------------------+------+------+-------------+----------+----------------------+------------------+-------+--------------+--------------+-------+-------+-------+--------------------------------------------------+-------+--------------------------------+----------
   370 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
  -340 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
  9260 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
   190 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
 12120 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
  9260 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
  1250 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
   480 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
   480 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
 12120 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
   370 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
  -230 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
  -340 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
  1250 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
   190 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
  2120 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
  2120 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
  -230 | 3W9awb6DnWDGOGr | 4830959 |   38 | epzhtqukYCyZNZbI | f    | t    | freighter   | $%^&*    | 爱情不幸福           | "4 vợ 5 vợ 6 v"  | f     |  10781647619 |    4988.9871 | id3   | f     | id3   | 当他等待淋浴温暖时，他注意到他能听到水的变化温度 | id3   | 彼はなぜ18歳で彼が             |    31246
  1250 | FaQLQ3WFGnMYWIe | 5637128 | 7663 | bafdZoYyqSgiklyQ | t    | f    | average     | &^%&^%$# | 悲观失望希望美丽     | "3ck4"           | f     |      6146714 |    657898.01 | id1   | t     | id1   | 生活中没有什么比一块馅饼好                       | id1   | lを着た豚は誰も好きではない    |  8888888
 12120 | bNq9sRC3qfxY99a | 5061715 | 8578 | yZuKWGiQOFXDNAJm | t    | f    | attract     | $%^&*    | 辛辣仇恨挫败悲观情绪 | "1 vợ"           | t     |        13653 | 154581.27841 | id1   | t     | id1   | 那就是他如何赢得100万美元                        | id1   | 彼は豚が                       | 14681764
  -340 | 1wBi4XmD6vOCRM7 | 2462190 | 4366 | SOlGbhjGOauCvZrK | f    | t    | cooperation | @&*$%^&  | 生活无聊             | "1 chồng 2 ck "  | f     | 361645187500 |     178617.7 | id4   | f     | id4   | 黎明起床是为了鸟                                 | id4   | 彼はなぜ18歳で彼がHHJAHJGYJB   | 12315475
  2120 | bMBOphOey0kXMun | 9655923 | 3646 | BOQGiWddylrRFmKs | f    | t    | constraint  | !@#$%^   | 讨厌生活             | "1 vợ 2 vợ 3 vợ" | t     |        13167 |    9883.4341 | id2   | t     | id2   | 明天将带来新的事物，所以今天就留下美好的回忆     | id2   | 誰が作ったのか誰も質問しません |     1232
  -230 |                 |         |      |                  |      |      |             |          |                      |                  |       |              |              |       |       |       |                                                  |       |                                |         
(23 rows)

-- Select all data with aggregate
--Testcase 45:
select max(time), count(tags->>'sid1'), sum((tags->>'sid2')::bigint) from sctbl4 GROUP BY time,tags->>'sid1',(tags->>'sid2')::bigint,(fields->>'sig1')::bigint ORDER BY (fields->>'sig1')::bigint;
         max         | count |   sum   
---------------------+-------+---------
 1970-04-11 10:42:54 |     1 | 2462190
 1970-01-01 14:36:06 |     0 |        
 1970-01-01 00:02:22 |     0 |        
 1970-01-01 12:05:46 |     0 |        
 1970-01-08 08:36:26 |     1 | 4830959
 1970-10-28 16:19:12 |     0 |        
 1970-01-01 00:40:25 |     0 |        
 1970-01-02 03:22:22 |     0 |        
 1970-01-01 00:01:39 |     0 |        
 1970-01-01 11:45:51 |     0 |        
 1970-01-01 03:27:11 |     0 |        
 1970-01-01 02:24:38 |     0 |        
 1970-01-01 02:22:58 |     0 |        
 1970-01-01 15:10:28 |     0 |        
 1970-01-09 14:58:54 |     1 | 5637128
 1970-01-08 07:33:03 |     0 |        
 1970-01-07 01:54:05 |     0 |        
 1970-06-14 12:42:25 |     1 | 9655923
 1970-01-01 01:38:47 |     0 |        
 1970-01-01 00:16:26 |     0 |        
 1970-01-01 01:27:15 |     0 |        
 1970-01-28 02:39:14 |     1 | 5061715
 1970-01-01 06:30:42 |     0 |        
(23 rows)

--Testcase 46:
select string_agg(tags->>'sid19', tags->>'sid17'), avg((tags->>'sid3')::bigint), stddev((tags->>'sid13')::double precision) from sctbl4 GROUP BY tags->>'sid17',tags->>'sid19',(tags->>'sid3')::bigint,(tags->>'sid13')::double precision,(fields->>'sig1')::bigint ORDER BY (fields->>'sig1')::bigint;
           string_agg           |          avg          | stddev 
--------------------------------+-----------------------+--------
                                |                       |       
 彼はなぜ18歳で彼がHHJAHJGYJB   | 4366.0000000000000000 |       
 彼はなぜ18歳で彼が             |   38.0000000000000000 |       
                                |                       |       
                                |                       |       
                                |                       |       
                                |                       |       
                                |                       |       
 lを着た豚は誰も好きではない    | 7663.0000000000000000 |       
                                |                       |       
 誰が作ったのか誰も質問しません | 3646.0000000000000000 |       
                                |                       |       
                                |                       |       
 彼は豚が                       | 8578.0000000000000000 |       
(14 rows)

--Testcase 47:
select sum((tags->>'sid3')::bigint), sum((tags->>'sid20')::bigint), bool_and((tags->>'sid5')::boolean != (tags->>'sid6')::boolean) from sctbl4 GROUP BY (fields->>'sig2' COLLATE "en_US") ORDER BY (fields->>'sig2' COLLATE "en_US");
 sum  |   sum    | bool_and 
------+----------+----------
      |          | 
      |          | 
      |          | 
 8578 | 14681764 | t
 3646 |     1232 | t
   38 |    31246 | t
      |          | 
      |          | 
 7663 |  8888888 | t
      |          | 
 4366 | 12315475 | t
      |          | 
(12 rows)

--Testcase 48:
select stddev((tags->>'sid20')::bigint), avg((tags->>'sid2')::bigint order by (tags->>'sid2')::bigint), min(tags->>'sid10') from sctbl4 GROUP BY fields->>'sig3' ORDER BY (fields->>'sig3')::double precision;
 stddev |         avg          |       min        
--------+----------------------+------------------
        |                      | 
        |                      | 
        |                      | 
        |                      | 
        | 5061715.000000000000 | "1 vợ"
        | 9655923.000000000000 | "1 vợ 2 vợ 3 vợ"
        | 4830959.000000000000 | "4 vợ 5 vợ 6 v"
        | 2462190.000000000000 | "1 chồng 2 ck "
        | 5637128.000000000000 | "3ck4"
        |                      | 
        |                      | 
        |                      | 
        |                      | 
        |                      | 
        |                      | 
        |                      | 
        |                      | 
        |                      | 
        |                      | 
        |                      | 
        |                      | 
        |                      | 
(22 rows)

--Testcase 49:
select every((tags->>'sid11')::boolean = (tags->>'sid15')::boolean), bool_or((tags->>'sid6')::boolean != (tags->>'sid11')::boolean), count(time) from sctbl4 GROUP BY (fields->>'sig2' COLLATE "en_US") ORDER BY (fields->>'sig2' COLLATE "en_US");
 every | bool_or | count 
-------+---------+-------
       |         |     2
       |         |     2
       |         |     1
 t     | t       |     2
 t     | f       |     3
 t     | t       |     3
       |         |     2
       |         |     1
 f     | f       |     2
       |         |     1
 t     | t       |     3
       |         |     1
(12 rows)

--Testcase 50:
select count(*), sum((tags->>'sid3')::bigint), string_agg(tags->>'sid9', tags->>'sid17') from sctbl4 GROUP BY fields->>'sig3' ORDER BY (fields->>'sig3')::double precision;
 count | sum  |      string_agg      
-------+------+----------------------
     1 |      | 
     1 |      | 
     1 |      | 
     2 |      | 
     1 | 8578 | 辛辣仇恨挫败悲观情绪
     1 | 3646 | 讨厌生活
     1 |   38 | 爱情不幸福
     1 | 4366 | 生活无聊
     1 | 7663 | 悲观失望希望美丽
     1 |      | 
     1 |      | 
     1 |      | 
     1 |      | 
     1 |      | 
     1 |      | 
     1 |      | 
     1 |      | 
     1 |      | 
     1 |      | 
     1 |      | 
     1 |      | 
     1 |      | 
(22 rows)

--Testcase 51:
select count(tags->>'sid1'), bool_and(tags->>'sid4' != '%c%'), max(tags->>'sid8') from sctbl4 GROUP BY fields->>'sig1' ORDER BY (fields->>'sig1')::bigint;
 count | bool_and |   max    
-------+----------+----------
     1 | t        | @&*$%^&
     1 | t        | $%^&*
     0 |          | 
     0 |          | 
     0 |          | 
     1 | t        | &^%&^%$#
     1 | t        | !@#$%^
     0 |          | 
     1 | t        | $%^&*
(9 rows)

--Testcase 52:
select bool_and((tags->>'sid6')::boolean != false), min((tags->>'sid13')::double precision), avg((tags->>'sid20')::bigint) from sctbl4 GROUP BY fields->>'sig4' ORDER BY fields->>'sig4';
 bool_and |     min      |          avg          
----------+--------------+-----------------------
 f        |    4988.9871 |  2973788.666666666667
 f        | 154581.27841 | 13498619.500000000000
(2 rows)

--Testcase 53:
select stddev((tags->>'sid13')::double precision), sum((tags->>'sid12')::bigint), string_agg(tags->>'sid7', tags->>'sid17') from sctbl4  GROUP BY fields->>'sig1' ORDER BY (fields->>'sig1')::bigint;
 stddev |     sum      | string_agg  
--------+--------------+-------------
        | 361645187500 | cooperation
        |  10781647619 | freighter
        |              | 
        |              | 
        |              | 
        |      6146714 | average
        |        13167 | constraint
        |              | 
        |        13653 | attract
(9 rows)

--Testcase 54:
select stddev((tags->>'sid3')::bigint), min(tags->>'sid10'), max(tags->>'sid4') from sctbl4 GROUP BY (fields->>'sig4')::boolean ORDER BY (fields->>'sig4')::boolean;
      stddev       |       min        |       max        
-------------------+------------------+------------------
 3814.327769520251 | "1 vợ 2 vợ 3 vợ" | epzhtqukYCyZNZbI
 2978.333762357738 | "1 chồng 2 ck "  | yZuKWGiQOFXDNAJm
(2 rows)

--Testcase 55:
select string_agg(tags->>'sid19', tags->>'sid4'), string_agg(tags->>'sid9', tags->>'sid1'), max(time) from sctbl4 GROUP BY fields->>'sig3' ORDER BY (fields->>'sig3')::double precision;
           string_agg           |      string_agg      |         max         
--------------------------------+----------------------+---------------------
                                |                      | 1970-01-01 02:22:58
                                |                      | 1970-01-01 06:30:42
                                |                      | 1970-01-01 00:16:26
                                |                      | 1970-01-01 12:05:46
 彼は豚が                       | 辛辣仇恨挫败悲观情绪 | 1970-01-28 02:39:14
 誰が作ったのか誰も質問しません | 讨厌生活             | 1970-06-14 12:42:25
 彼はなぜ18歳で彼が             | 爱情不幸福           | 1970-01-08 08:36:26
 彼はなぜ18歳で彼がHHJAHJGYJB   | 生活无聊             | 1970-04-11 10:42:54
 lを着た豚は誰も好きではない    | 悲观失望希望美丽     | 1970-01-09 14:58:54
                                |                      | 1970-01-08 07:33:03
                                |                      | 1970-10-28 16:19:12
                                |                      | 1970-01-01 15:10:28
                                |                      | 1970-01-01 01:38:47
                                |                      | 1970-01-01 11:45:51
                                |                      | 1970-01-01 02:24:38
                                |                      | 1970-01-02 03:22:22
                                |                      | 1970-01-01 14:36:06
                                |                      | 1970-01-01 00:01:39
                                |                      | 1970-01-07 01:54:05
                                |                      | 1970-01-01 00:40:25
                                |                      | 1970-01-01 01:27:15
                                |                      | 1970-01-01 03:27:11
(22 rows)

--Testcase 56:
select avg((tags->>'sid3')::bigint), count(*), every((tags->>'sid15')::boolean != (tags->>'sid5')::boolean) from sctbl4 GROUP BY fields->>'sig1' ORDER BY (fields->>'sig1')::bigint;
          avg          | count | every 
-----------------------+-------+-------
 4366.0000000000000000 |     3 | f
   38.0000000000000000 |     3 | f
                       |     2 | 
                       |     2 | 
                       |     2 | 
 7663.0000000000000000 |     3 | f
 3646.0000000000000000 |     3 | t
                       |     2 | 
 8578.0000000000000000 |     3 | f
(9 rows)

--Testcase 57:
select every((tags->>'sid6')::boolean = (tags->>'sid11')::boolean), string_agg(tags->>'sid14', tags->>'sid16'), string_agg(tags->>'sid18', tags->>'sid19') from sctbl4 GROUP BY fields->>'sig4' ORDER BY fields->>'sig4';
 every |   string_agg    |                             string_agg                             
-------+-----------------+--------------------------------------------------------------------
 f     | id3id1id1id2id2 | id3lを着た豚は誰も好きではないid1誰が作ったのか誰も質問しませんid2
 f     | id1id4id4       | id1彼はなぜ18歳で彼がHHJAHJGYJBid4
(2 rows)

--Testcase 58:
select stddev((tags->>'sid12')::double precision), stddev((tags->>'sid13')::double precision), sum((tags->>'sid13')::double precision) from sctbl4 GROUP BY fields->>'sig1' ORDER BY (fields->>'sig1')::bigint;
 stddev | stddev |     sum      
--------+--------+--------------
        |        |     178617.7
        |        |    4988.9871
        |        |             
        |        |             
        |        |             
        |        |    657898.01
        |        |    9883.4341
        |        |             
        |        | 154581.27841
(9 rows)

-- Select aggregate contain expression
--Testcase 59:
select max((tags->>'sid2')::bigint / (tags->>'sid3')::bigint + (fields->>'sig3')::double precision), avg((tags->>'sid20')::bigint - (fields->>'sig3')::double precision * (tags->>'sid3')::bigint), sum((tags->>'sid2')::bigint + (fields->>'sig3')::double precision / (tags->>'sid3')::bigint) from sctbl4 GROUP BY tags->>'sid20' ORDER BY (tags->>'sid20')::bigint;
   max    |    avg     |        sum        
----------+------------+-------------------
   2658.2 |   -35957.2 | 9655923.002797587
 127140.3 |    30854.6 | 4830959.271052632
    755.5 |  8731796.5 | 5637128.002675192
    583.4 | 12226408.6 | 2462190.004672469
    600.1 | 14595126.2 | 5061715.001177431
          |            |                  
(6 rows)

--Testcase 60:
select string_agg(tags->>'sid19' || (fields->>'sig2')::text, tags->>'sid17' || (tags->>'sid1')::text), avg((tags->>'sid3')::bigint * (tags->>'sid2')::bigint - (tags->>'sid12')::bigint), stddev((tags->>'sid13')::double precision / (tags->>'sid3')::bigint + (tags->>'sid12')::bigint) from sctbl4 GROUP BY tags->>'sid19' ORDER BY tags->>'sid19';
                 string_agg                  |          avg           | stddev 
---------------------------------------------+------------------------+--------
 lを着た豚は誰も好きではないシステム         |   43191165150.00000000 |       
 彼はなぜ18歳で彼がC)@maEFJAe=3kake          |  -10598071177.00000000 |       
 彼はなぜ18歳で彼がHHJAHJGYJB装置開発機能仕  | -350895265960.00000000 |       
 彼は豚がaoaowejf                            |   43419377617.00000000 |       
 誰が作ったのか誰も質問しませんBAEFOAWJ#AWEK |   35205482091.00000000 |       
                                             |                        |       
(6 rows)

--Testcase 61:
select sum((tags->>'sid3')::bigint - (tags->>'sid2')::bigint - (fields->>'sig1')::bigint), sum((tags->>'sid20')::bigint - (tags->>'sid13')::double precision + (tags->>'sid2')::bigint), bool_and((tags->>'sid5')::boolean AND (tags->>'sid6')::boolean OR (fields->>'sig4')::boolean) from sctbl4 GROUP BY tags->>'sid18' ORDER BY tags->>'sid18';
    sum    |      sum       | bool_and 
-----------+----------------+----------
 -10695972 | 33457015.71159 | f
  -9654397 |   9647271.5659 | f
  -4830691 |   4857216.0129 | f
  -2457484 |     14599047.3 | t
           |                | t
(5 rows)

--Testcase 62:
select stddev((tags->>'sid12')::bigint * (tags->>'sid20')::bigint / (tags->>'sid2')::bigint), avg((tags->>'sid2')::bigint + (tags->>'sid3')::bigint / (tags->>'sid12')::bigint), min(tags->>'sid10' || 'BkbKJBT45%^&') from sctbl4 GROUP BY tags->>'sid16' ORDER BY tags->>'sid16';
    stddev    |         avg          |             min              
--------------+----------------------+------------------------------
 6825578.7222 | 5349421.500000000000 | "1 vợ"BkbKJBT45%^&
              | 9655923.000000000000 | "1 vợ 2 vợ 3 vợ"BkbKJBT45%^&
              | 4830959.000000000000 | "4 vợ 5 vợ 6 v"BkbKJBT45%^&
              | 2462190.000000000000 | "1 chồng 2 ck "BkbKJBT45%^&
              |                      | 
(5 rows)

--Testcase 63:
select every((tags->>'sid6')::boolean = (tags->>'sid15')::boolean), bool_or(tags->>'sid4' LIKE 'Hello'), sum((fields->>'sig1')::bigint * (fields->>'sig3')::double precision - (tags->>'sid20')::bigint) from sctbl4 GROUP BY tags->>'sid15' ORDER BY tags->>'sid15';
 every | bool_or |    sum    
-------+---------+-----------
 f     | f       | -12356026
 f     | f       | -23402223
       |         |          
(3 rows)

--Testcase 64:
select every((tags->>'sid5')::boolean <> (tags->>'sid6')::boolean), sum((tags->>'sid2')::bigint / (fields->>'sig1')::bigint * (fields->>'sig3')::double precision), string_agg(tags->>'sid9' || (tags->>'sid18')::text, tags->>'sid17' || (tags->>'sid16')::text) from sctbl4 GROUP BY tags->>'sid14' ORDER BY tags->>'sid14';
 every |        sum         |                               string_agg                               
-------+--------------------+------------------------------------------------------------------------
 t     |            96646.2 | 悲观失望希望美丽id1那就是他如何赢得100万美元id1辛辣仇恨挫败悲观情绪id1
 t     | 46450.799999999996 | 讨厌生活id2
 t     |          -216341.2 | 爱情不幸福id3
 t     |          -147716.4 | 生活无聊id4
       |                    | 
(5 rows)

--Testcase 65:
select min((fields->>'sig1')::bigint * (tags->>'sid20')::bigint - (tags->>'sid13')::double precision), bool_and(tags->>'sid4' != '%c%' AND tags->>'sid4' != '%a%'), max((tags->>'sid3')::bigint - (fields->>'sig3')::double precision + (tags->>'sid12')::double precision) from sctbl4 GROUP BY tags->>'sid13' ORDER BY (tags->>'sid13')::double precision;
        min        | bool_and |      max       
-------------------+----------+----------------
     -7191568.9871 | t        |  10781647646.7
      2601956.5659 | t        |        16802.8
 177942825098.7216 | t        |        22220.9
     -4187440117.7 | t        | 361645191845.6
    11110452101.99 | t        |      6154356.5
                   |          |               
(6 rows)

--Testcase 66:
select bool_and((tags->>'sid6')::boolean != false OR (tags->>'sid11')::boolean = true), min((tags->>'sid13')::double precision / (fields->>'sig3')::double precision - (tags->>'sid12')::bigint), avg((tags->>'sid20')::bigint / (tags->>'sid12')::bigint + (tags->>'sid3')::bigint) from sctbl4 GROUP BY tags->>'sid12' ORDER BY (tags->>'sid12')::bigint;
 bool_and |         min         |          avg          
----------+---------------------+-----------------------
 t        | -12198.035872549019 | 3646.0000000000000000
 t        |  1652.0770702970294 | 9653.0000000000000000
 f        |  -6114621.414146341 | 7664.0000000000000000
 t        |  -10781647134.63232 |   38.0000000000000000
 t        |  -361645178744.2304 | 4366.0000000000000000
          |                     |                      
(6 rows)

--Testcase 67:
select stddev((tags->>'sid13')::double precision + (fields->>'sig1')::bigint * (tags->>'sid2')::bigint), sum((tags->>'sid12')::bigint + (tags->>'sid20')::bigint - (tags->>'sid3')::bigint), string_agg(tags->>'sid7' || '豚は誰も好', 'なぜ18歳で' || (tags->>'sid17')::text) from sctbl4 GROUP BY (tags->>'sid8' COLLATE "en_US") ORDER BY (tags->>'sid8' COLLATE "en_US");
      stddev       |     sum      |                               string_agg                                
-------------------+--------------+-------------------------------------------------------------------------
                   |        10753 | constraint豚は誰も好
                   |     15027939 | average豚は誰も好
                   | 361657498609 | cooperation豚は誰も好
 44165363438.80249 |  10796365666 | freighter豚は誰も好なぜ18歳で那就是他如何赢得100万美元attract豚は誰も好
                   |              | 
(5 rows)

--Testcase 68:
select stddev((tags->>'sid3')::bigint * (tags->>'sid2')::bigint - (tags->>'sid20')::bigint), min(tags->>'sid10' || '12345#$%&7' || (tags->>'sid19')::text), every(tags->>'sid4' IN ('japan', 'vietnam')) from sctbl4 GROUP BY tags->>'sid9' ORDER BY tags->>'sid9';
 stddev |                           min                            | every 
--------+----------------------------------------------------------+-------
        | "3ck4"12345#$%&7lを着た豚は誰も好きではない              | f
        | "4 vợ 5 vợ 6 v"12345#$%&7彼はなぜ18歳で彼が              | f
        | "1 chồng 2 ck "12345#$%&7彼はなぜ18歳で彼がHHJAHJGYJB    | f
        | "1 vợ 2 vợ 3 vợ"12345#$%&7誰が作ったのか誰も質問しません | f
        | "1 vợ"12345#$%&7彼は豚が                                 | f
        |                                                          | 
(6 rows)

-- Select combine-aggregate
--Testcase 69:
select stddev((tags->>'sid3')::bigint) + count(tags->>'sid10') + count(tags->>'sid4'), count(time) + count(tags->>'sid1') - sum((tags->>'sid2')::bigint), avg((tags->>'sid3')::bigint) * count(*) + count(tags->>'sid17') from sctbl4 GROUP BY (fields->>'sig2' COLLATE "en_US") ORDER BY (fields->>'sig2' COLLATE "en_US");
 ?column? | ?column? |        ?column?        
----------+----------+------------------------
          |          |                       
          |          |                       
          |          |                       
          | -5061712 | 17157.0000000000000000
          | -9655919 | 10939.0000000000000000
          | -4830955 |   115.0000000000000000
          |          |                       
          |          |                       
          | -5637125 | 15327.0000000000000000
          |          |                       
          | -2462186 | 13099.0000000000000000
          |          |                       
(12 rows)

--Testcase 70:
select stddev((tags->>'sid13')::double precision) * avg((fields->>'sig1')::bigint) / avg((fields->>'sig3')::double precision), sum((tags->>'sid2')::bigint) / count(tags->>'sid10') + sum((fields->>'sig1')::bigint), stddev((fields->>'sig3')::double precision) / stddev((tags->>'sid12')::double precision) - min((tags->>'sid12')::double precision) from sctbl4 GROUP BY tags->>'sid2' ORDER BY (tags->>'sid2')::bigint;
 ?column? |       ?column?       | ?column? 
----------+----------------------+----------
          | 2461850.000000000000 |         
          | 4830729.000000000000 |         
          | 5073835.000000000000 |         
          | 5638378.000000000000 |         
          | 9658043.000000000000 |         
          |                      |         
(6 rows)

--Testcase 71:
select string_agg(tags->>'sid7' || (tags->>'sid10')::text || (tags->>'sid4')::text, tags->>'sid7' || 'JBkbg7t96' || (tags->>'sid18')::text), avg((tags->>'sid2')::bigint) - stddev((fields->>'sig3')::double precision) + avg((tags->>'sid12')::bigint), bool_and(tags->>'sid19' LIKE '%な%') OR bool_and((tags->>'sid5')::boolean = true) AND bool_or((tags->>'sid6')::boolean) from sctbl4 GROUP BY tags->>'sid3' ORDER BY (tags->>'sid3')::bigint;
                 string_agg                 | ?column? | ?column? 
--------------------------------------------+----------+----------
 freighter"4 vợ 5 vợ 6 v"epzhtqukYCyZNZbI   |          | t
 constraint"1 vợ 2 vợ 3 vợ"BOQGiWddylrRFmKs |          | f
 cooperation"1 chồng 2 ck "SOlGbhjGOauCvZrK |          | t
 average"3ck4"bafdZoYyqSgiklyQ              |          | t
 attract"1 vợ"yZuKWGiQOFXDNAJm              |          | f
                                            |          | 
(6 rows)

--Testcase 72:
select avg((tags->>'sid3')::bigint) + count(*) - sum((tags->>'sid20')::bigint), every((tags->>'sid15')::boolean != (tags->>'sid5')::boolean) OR bool_and((tags->>'sid15')::boolean) AND bool_or((tags->>'sid6')::boolean), string_agg(tags->>'sid14' || (tags->>'sid16')::text || (tags->>'sid18')::text, tags->>'sid17' || '&^&*$^&*^*' || (tags->>'sid19')::text) from sctbl4 GROUP BY fields->>'sig1' ORDER BY (fields->>'sig1')::bigint;
          ?column?          | ?column? | string_agg 
----------------------------+----------+------------
 -12311106.0000000000000000 | f        | id4id4id4
    -31205.0000000000000000 | f        | id3id3id3
                            |          | 
                            |          | 
                            |          | 
  -8881222.0000000000000000 | f        | id1id1id1
      2417.0000000000000000 | t        | id2id2id2
                            |          | 
 -14673183.0000000000000000 | f        | id1id1id1
(9 rows)

--Testcase 73:
select bool_and((tags->>'sid11')::boolean) AND bool_or((tags->>'sid11')::boolean) OR true, count(time) + count(tags->>'sid1') - sum((tags->>'sid3')::bigint), count(tags->>'sid1') + count(tags->>'sid10') - avg((tags->>'sid3')::bigint) from sctbl4 GROUP BY fields->>'sig4' ORDER BY fields->>'sig4';
 ?column? | ?column? |        ?column?        
----------+----------+------------------------
 t        |   -11329 | -3776.3333333333333333
 t        |   -12934 | -6468.0000000000000000
(2 rows)

--Testcase 74:
select bool_or(tags->>'sid16' = 'id1') OR false AND every((tags->>'sid15')::boolean), string_agg(tags->>'sid14' || (tags->>'sid8')::text || (tags->>'sid4')::text, (tags->>'sid14')::text), avg((tags->>'sid2')::bigint) + avg((tags->>'sid3')::bigint) - avg((tags->>'sid12')::bigint) from sctbl4 GROUP BY fields->>'sig4' ORDER BY fields->>'sig4';
 ?column? |                                     string_agg                                     |            ?column?            
----------+------------------------------------------------------------------------------------+--------------------------------
 t        | id3$%^&*epzhtqukYCyZNZbIid1id1&^%&^%$#bafdZoYyqSgiklyQid2id2!@#$%^BOQGiWddylrRFmKs |   -3589224047.6666666633336667
 t        | id1$%^&*yZuKWGiQOFXDNAJmid4id4@&*$%^&SOlGbhjGOauCvZrK                              | -180818832152.0000000000000000
(2 rows)

--Testcase 75:
select bool_and(time > '1900-09-09 23:59:00+00') AND bool_and((fields->>'sig4')::boolean) AND every((fields->>'sig4')::boolean), stddev((tags->>'sid20')::bigint) / stddev((fields->>'sig1')::bigint) / sum((tags->>'sid13')::double precision), stddev((tags->>'sid13')::double precision) / sum((tags->>'sid13')::double precision) * count(*) from sctbl4 GROUP BY tags->>'sid7' ORDER BY tags->>'sid7';
 ?column? | ?column? | ?column? 
----------+----------+----------
 t        |          |         
 f        |          |         
 f        |          |         
 t        |          |         
 f        |          |         
 f        |          |         
(6 rows)

--Testcase 76:
select sum((tags->>'sid2')::bigint) + count(tags->>'sid1') - count(tags->>'sid8'), count((fields->>'sig3')::double precision) - count(tags->>'sid9') + count(tags->>'sid17'), string_agg(tags->>'sid19' || 'hf675578ytgu', tags->>'sid17' || (tags->>'sid14')::text) from sctbl4 GROUP BY (tags->>'sid8' COLLATE "en_US") ORDER BY (tags->>'sid8' COLLATE "en_US");
 ?column? | ?column? |                                   string_agg                                   
----------+----------+--------------------------------------------------------------------------------
  9655923 |        1 | 誰が作ったのか誰も質問しませんhf675578ytgu
  5637128 |        1 | lを着た豚は誰も好きではないhf675578ytgu
  2462190 |        1 | 彼はなぜ18歳で彼がHHJAHJGYJBhf675578ytgu
  9892674 |        2 | 彼はなぜ18歳で彼がhf675578ytgu那就是他如何赢得100万美元id1彼は豚がhf675578ytgu
          |       18 | 
(5 rows)

--Testcase 77:
select sum((tags->>'sid3')::bigint) - avg((tags->>'sid12')::bigint) * count(tags->>'sid9'), bool_and((tags->>'sid11')::boolean) AND bool_and((tags->>'sid20')::bigint >= -16735467) OR every(tags->>'sid16' != 'id3'), sum((tags->>'sid20')::bigint) + avg((tags->>'sid12')::bigint) / count(tags->>'sid19') from sctbl4 GROUP BY (fields->>'sig2' COLLATE "en_US") ORDER BY (fields->>'sig2' COLLATE "en_US");
        ?column?        | ?column? |         ?column?          
------------------------+----------+---------------------------
                        |          |                          
                        |          |                          
                        |          |                          
 -5075.0000000000000000 | t        | 14695417.0000000000000000
 -9521.0000000000000000 | t        |    14399.0000000000000000
  -10781647581.00000000 | f        |      10781678865.00000000
                        |          |                          
                        |          |                          
  -6139051.000000000000 | t        |     15035602.000000000000
                        |          |                          
 -361645183134.00000000 | t        |     361657502975.00000000
                        |          |                          
(12 rows)

--Testcase 78:
select string_agg(tags->>'sid19' || (tags->>'sid17')::text || (tags->>'sid10')::text, tags->>'sid9' || (tags->>'sid8')::text || (tags->>'sid7')::text), avg((tags->>'sid20')::bigint) / avg((tags->>'sid2')::bigint) + stddev((tags->>'sid12')::bigint), count(tags->>'sid1') - count(tags->>'sid14') + count((fields->>'sig3')::double precision) from sctbl4 GROUP BY (tags->>'sid10' COLLATE "en_US") ORDER BY (tags->>'sid10' COLLATE "en_US");
                                         string_agg                                         | ?column? | ?column? 
--------------------------------------------------------------------------------------------+----------+----------
 彼はなぜ18歳で彼がHHJAHJGYJB黎明起床是为了鸟"1 chồng 2 ck "                                |          |        1
 彼は豚が那就是他如何赢得100万美元"1 vợ"                                                    |          |        1
 誰が作ったのか誰も質問しません明天将带来新的事物，所以今天就留下美好的回忆"1 vợ 2 vợ 3 vợ" |          |        1
 lを着た豚は誰も好きではない生活中没有什么比一块馅饼好"3ck4"                                |          |        1
 彼はなぜ18歳で彼が当他等待淋浴温暖时，他注意到他能听到水的变化温度"4 vợ 5 vợ 6 v"          |          |        1
                                                                                            |          |       18
(6 rows)

-- Select with WHERE multi-condition
--Testcase 79:
select avg((fields->>'sig3')::double precision + (tags->>'sid3')::bigint / (tags->>'sid12')::bigint), count(time) + count(tags->>'sid1') - sum((tags->>'sid2')::bigint), every((tags->>'sid11')::boolean = (tags->>'sid15')::boolean) from sctbl4 WHERE tags->>'sid9' LIKE '%挫败%' OR (tags->>'sid5')::boolean <> true OR tags->>'sid16' ILIKE 'id4' AND (tags->>'sid20')::bigint < 0 GROUP BY tags->>'sid11' ORDER BY tags->>'sid11';
        avg         | ?column?  | every 
--------------------+-----------+-------
              15.35 |  -7293145 | t
 10.149999999999999 | -14717634 | t
(2 rows)

--Testcase 80:
select avg((tags->>'sid2')::bigint), count(*), every((tags->>'sid11')::boolean != (tags->>'sid5')::boolean) from sctbl4 WHERE (tags->>'sid20')::bigint > 100000 AND (tags->>'sid6')::boolean != true OR tags->>'sid16' LIKE '2i3uth78wgbg' AND tags->>'sid1' ILIKE 'bMBOphOey0kXMun' GROUP BY fields->>'sig1' ORDER BY (fields->>'sig1')::bigint;
         avg          | count | every 
----------------------+-------+-------
 5637128.000000000000 |     1 | t
 5061715.000000000000 |     1 | f
(2 rows)

--Testcase 81:
select every((tags->>'sid6')::boolean <> (tags->>'sid11')::boolean), string_agg(tags->>'sid1', tags->>'sid16'), string_agg(tags->>'sid18', tags->>'sid7') from sctbl4 WHERE (tags->>'sid13')::double precision > 0.985689524 OR tags->>'sid8' LIKE '%^%' OR (tags->>'sid15')::boolean = true OR tags->>'sid4' IN ('%1%', '516541') GROUP BY fields->>'sig1',fields->>'sig3' ORDER BY (fields->>'sig3')::double precision;
 every |   string_agg    | string_agg 
-------+-----------------+------------
 t     | bNq9sRC3qfxY99a | id1
 f     | bMBOphOey0kXMun | id2
 t     | 3W9awb6DnWDGOGr | id3
 t     | 1wBi4XmD6vOCRM7 | id4
 f     | FaQLQ3WFGnMYWIe | id1
(5 rows)

--Testcase 82:
select string_agg(tags->>'sid16', tags->>'sid17'), avg((tags->>'sid13')::double precision), stddev((tags->>'sid12')::bigint) from sctbl4 WHERE (tags->>'sid6')::boolean <> false AND tags->>'sid19' LIKE 'ターフェー' AND tags->>'sid17' LIKE 'akewo0' AND tags->>'sid10' IN ('%2%', '%vợ%') GROUP BY tags->>'sid14',fields->>'sig2',fields->>'sig3' ORDER BY tags->>'sid14',fields->>'sig2',(fields->>'sig3')::double precision;
 string_agg | avg | stddev 
------------+-----+--------
(0 rows)

--Testcase 83:
select stddev((tags->>'sid13')::double precision + (fields->>'sig1')::bigint * (tags->>'sid2')::bigint), bool_or(tags->>'sid4' LIKE 'xinchao'), sum((fields->>'sig1')::bigint * (fields->>'sig3')::double precision - (tags->>'sid20')::bigint) from sctbl4 WHERE tags->>'sid4' IN ('%japnam', 'vietpan%') OR (tags->>'sid11')::boolean = true OR (tags->>'sid13')::double precision < 99999999999.99 OR (fields->>'sig3')::double precision > 0 GROUP BY (fields->>'sig1')::bigint,(fields->>'sig3')::double precision ORDER BY (fields->>'sig1')::bigint;
 stddev | bool_or |    sum    
--------+---------+-----------
        | f       | -12322411
        |         |          
        |         |          
        | f       |    -33615
        |         |          
        |         |          
        |         |          
        |         |          
        |         |          
        |         |          
        | f       |  -8863263
        |         |          
        |         |          
        | f       |     20392
        |         |          
        |         |          
        | f       | -14559352
        |         |          
(18 rows)

-- Select with HAVING LIMIT OFFSET
--Testcase 84:
select stddev((tags->>'sid2')::bigint * 0.9804754 + (tags->>'sid3')::bigint), min((tags->>'sid13')::double precision / ((fields->>'sig1')::bigint + 3.144)), stddev((tags->>'sid20')::bigint * (tags->>'sid2')::bigint - (tags->>'sid13')::double precision) from sctbl4 WHERE (fields->>'sig3')::double precision >= -999995.955 GROUP BY (fields->>'sig1')::bigint,(fields->>'sig3')::double precision HAVING (fields->>'sig3')::double precision > 0 ORDER BY (fields->>'sig1')::bigint LIMIT 10 OFFSET 10;
 stddev |        min         | stddev 
--------+--------------------+--------
        |  524.9979331984193 |       
        |                    |       
        |  4.655093625302854 |       
        |                    |       
        |                    |       
        |                    |       
        | 12.750923226681131 |       
        |                    |       
(8 rows)

--Testcase 85:
select sum((fields->>'sig3')::double precision + (tags->>'sid3')::bigint * (tags->>'sid12')::bigint), string_agg(tags->>'sid7', tags->>'sid8'), string_agg(fields->>'sig2' || '568hvsvbka', 'も9質18問' || (tags->>'sid9')::text) from sctbl4 WHERE (fields->>'sig3')::double precision >= 0.3871647691 GROUP BY (fields->>'sig1')::bigint,(fields->>'sig3')::double precision,tags->>'sid15' HAVING (fields->>'sig3')::double precision <> 0 ORDER BY tags->>'sid15' LIMIT 10 OFFSET 0;
          sum           | string_agg  |         string_agg         
------------------------+-------------+----------------------------
 1.5789428886250205e+15 | cooperation | 装置開発機能仕568hvsvbka
         409702609532.3 | freighter   | C)@maEFJAe=3kake568hvsvbka
          47102269402.5 | average     | システム568hvsvbka
             48006892.2 | constraint  | BAEFOAWJ#AWEK568hvsvbka
            117115444.1 | attract     | aoaowejf568hvsvbka
                        |             | 装置開発機能仕568hvsvbka
                        |             | C)@maEFJAe=3kake568hvsvbka
                        |             | 012002'akewo02568hvsvbka
                        |             | 012002'akewo02568hvsvbka
                        |             | g029012568hvsvbka
(10 rows)

--Testcase 86:
select max (tags->>'sid10' || 'codonlangthang' || 'hoanghonhanoi'), sum ((tags->>'sid13')::double precision - (tags->>'sid12')::bigint - (tags->>'sid20')::bigint), avg((tags->>'sid2')::bigint + (tags->>'sid3')::bigint + (tags->>'sid12')::bigint) from sctbl4 WHERE (fields->>'sig1')::bigint <= 87986847478 GROUP BY (fields->>'sig1')::bigint,tags->>'sid10' HAVING tags->>'sid10' NOT IN ('%1 vợ%', '%1 chồng%') ORDER BY (fields->>'sig1')::bigint LIMIT 10 OFFSET 2;
                     max                     |        sum        |          avg          
---------------------------------------------+-------------------+-----------------------
 "4 vợ 5 vợ 6 v"codonlangthanghoanghonhanoi  | -10781673876.0129 |  10786478616.00000000
                                             |                   |                      
                                             |                   |                      
                                             |                   |                      
                                             |                   |                      
 "3ck4"codonlangthanghoanghonhanoi           |      -14377703.99 | 11791505.000000000000
                                             |                   |                      
 "1 vợ 2 vợ 3 vợ"codonlangthanghoanghonhanoi |        -4515.5659 |  9672736.000000000000
                                             |                   |                      
                                             |                   |                      
(10 rows)

--Testcase 87:
select stddev((tags->>'sid13')::double precision) * avg((tags->>'sid3')::bigint) / avg((tags->>'sid13')::double precision), sum((tags->>'sid2')::bigint) + max((fields->>'sig1')::bigint) + sum((tags->>'sid3')::bigint), stddev((tags->>'sid2')::bigint) / stddev((tags->>'sid12')::bigint) - min((tags->>'sid20')::bigint) from sctbl4 WHERE fields->>'sig2' NOT IN ('%c%', '%^%') GROUP BY tags->>'sid19' HAVING tags->>'sid19' != '%v' ORDER BY tags->>'sid19' LIMIT 10 OFFSET 0;
 ?column? | ?column? | ?column? 
----------+----------+----------
          |  5646041 |         
          |  4830767 |         
          |  2466216 |         
          |  5082413 |         
          |  9661689 |         
          |          |         
(6 rows)

--Testcase 88:
select bool_or((tags->>'sid2')::bigint / (tags->>'sid13')::double precision >= 15.5678), max ((tags->>'sid3')::bigint / (tags->>'sid20')::bigint * (tags->>'sid12')::bigint), every(((tags->>'sid13')::double precision - (tags->>'sid2')::bigint) < 0) from sctbl4 WHERE (fields->>'sig1')::bigint != 0 GROUP BY (fields->>'sig1')::bigint,(fields->>'sig3')::double precision,tags->>'sid20' HAVING (fields->>'sig3')::double precision != 0 ORDER BY (tags->>'sid20')::bigint LIMIT 10 OFFSET 5;
 bool_or | max | every 
---------+-----+-------
         |     | 
         |     | 
         |     | 
         |     | 
         |     | 
         |     | 
         |     | 
         |     | 
         |     | 
         |     | 
(10 rows)

-- Select JOIN
--Testcase 89:
select * from sctbl4 JOIN sctbl9 ON sctbl4.tags->>'sid14' = sctbl9.tags->>'sid' LIMIT 30 OFFSET 15;
 tags | fields | time | tags | fields | time 
------+--------+------+------+--------+------
(0 rows)

--Testcase 90:
select sctbl4.time, (sctbl4.fields->>'sig1')::bigint sig1, sctbl9.fields->>'sig2' sig2, (sctbl4.fields->>'sig3')::double precision sig3, (sctbl9.fields->>'sig4')::boolean sig4 from sctbl4 JOIN sctbl9 ON sctbl4.tags->>'sid' = sctbl9.tags->>'sid' ORDER BY sctbl4.time LIMIT 30 OFFSET 5;
        time         | sig1 |       sig2        |    sig3    | sig4 
---------------------+------+-------------------+------------+------
 1970-01-01 03:27:11 |  480 | 装置開111発機能仕 | 9826357635 | t
 1970-01-01 12:05:46 | -230 | C)@ma EFJAe=3kake |          0 | f
 1970-01-01 14:36:06 | -340 | 装置開111発機能仕 |    9384972 | t
 1970-01-07 01:54:05 | 2120 | BAEFOAWJ#AWEK     | 1023108589 | f
(4 rows)

--Testcase 91:
select sctbl9.time, (sctbl9.fields->>'sig1')::bigint sig1, sctbl9.fields->>'sig2' sig2, (sctbl4.fields->>'sig3')::double precision sig3, (sctbl9.fields->>'sig4')::boolean sig4, (sctbl4.tags->>'sid3')::bigint sid3, sctbl4.tags->>'sid' sid, (sctbl4.tags->>'sid3')::bigint sid3, sctbl4.tags->>'sid7' sid7 from sctbl4 JOIN sctbl9 ON sctbl4.tags->>'sid' = sctbl9.tags->>'sid' WHERE (sctbl4.fields->>'sig1')::bigint > (sctbl9.fields->>'sig1')::bigint AND sctbl4.fields->>'sig2' != NULL LIMIT 30 OFFSET 5;
 time | sig1 | sig2 | sig3 | sig4 | sid3 | sid | sid3 | sid7 
------+------+------+------+------+------+-----+------+------
(0 rows)

--Testcase 92:
select sctbl4.time, (sctbl9.fields->>'sig1')::bigint sig1, sctbl9.fields->>'sig2' sig2, (sctbl9.fields->>'sig3')::double precision sig3, (sctbl4.fields->>'sig4')::boolean sig4, (sctbl4.tags->>'sid13')::double precision sid13, sctbl4.tags->>'sid' sid, (sctbl4.tags->>'sid5')::boolean sid5, sctbl4.tags->>'sid16' sid16 from sctbl4 JOIN sctbl9 ON (sctbl4.fields->>'sig1')::bigint / (sctbl4.fields->>'sig3')::double precision < (sctbl9.fields->>'sig1')::bigint LIMIT 15 OFFSET 0;
ERROR:  division by zero
--Testcase 93:
select sctbl4.time, (sctbl4.fields->>'sig1')::bigint sig1, sctbl9.fields->>'sig2' sig2, (sctbl4.fields->>'sig3')::double precision sig3, (sctbl4.fields->>'sig4')::boolean sig4, sctbl4.tags->>'sid19' sid19 from sctbl4 JOIN sctbl9 ON (sctbl4.tags->>'sid3')::bigint BETWEEN -10000 AND 9999999 OR sctbl9.fields->>'sig2' ILIKE '%a%' ORDER BY sctbl4.time, sig1, sig2, sig3, sig4, sid19 LIMIT 10 OFFSET 0;
        time         | sig1 |        sig2         |    sig3    | sig4 | sid19 
---------------------+------+---------------------+------------+------+-------
 1970-01-01 00:01:39 |  370 | BAEFOAWJ#AWEK       |  109489057 | t    | 
 1970-01-01 00:01:39 |  370 | C)@ma EFJAe=3kake   |  109489057 | t    | 
 1970-01-01 00:01:39 |  370 | XINChaoTOIyeUcaCbaN |  109489057 | t    | 
 1970-01-01 00:02:22 | -340 | BAEFOAWJ#AWEK       |          0 | t    | 
 1970-01-01 00:02:22 | -340 | C)@ma EFJAe=3kake   |          0 | t    | 
 1970-01-01 00:02:22 | -340 | XINChaoTOIyeUcaCbaN |          0 | t    | 
 1970-01-01 00:16:26 | 9260 | BAEFOAWJ#AWEK       |        -24 | f    | 
 1970-01-01 00:16:26 | 9260 | C)@ma EFJAe=3kake   |        -24 | f    | 
 1970-01-01 00:16:26 | 9260 | XINChaoTOIyeUcaCbaN |        -24 | f    | 
 1970-01-01 00:40:25 |  190 | BAEFOAWJ#AWEK       | 3452697758 | f    | 
(10 rows)

--Testcase 94:
select sctbl4.time, (sctbl4.tags->>'sid15')::boolean sid15, (sctbl9.fields->>'sig4')::boolean sig4, sctbl4.fields->>'sig2' sig2, sctbl4.tags->>'sid8' sid8 from sctbl4 LEFT OUTER JOIN sctbl9 ON ((sctbl4.fields->>'sig3')::double precision = (sctbl9.fields->>'sig1')::bigint/25000 OR (sctbl4.fields->>'sig4')::boolean = (sctbl9.fields->>'sig4')::boolean) GROUP BY (sctbl4.fields->>'sig1')::bigint,sctbl4.time,(sctbl4.tags->>'sid15')::boolean,(sctbl9.fields->>'sig4')::boolean,sctbl4.fields->>'sig2',sctbl4.tags->>'sid8' HAVING (sctbl4.fields->>'sig1')::bigint > 0 LIMIT 10 OFFSET 2;
        time         | sid15 | sig4 |             sig2             |   sid8   
---------------------+-------+------+------------------------------+----------
 1970-01-09 14:58:54 | t     | f    | システム                     | &^%&^%$#
 1970-01-07 01:54:05 |       | f    | BAEFOAWJ#AWEK                | 
 1970-01-01 00:16:26 |       | f    | インターフェース設計検討資料 | 
 1970-01-01 06:30:42 |       | t    | aoao wejf                    | 
 1970-01-02 03:22:22 |       | f    | 012002'akewo02               | 
 1970-01-01 01:38:47 |       | f    | 設計 検討資料                | 
 1970-01-28 02:39:14 | t     | t    | aoaowejf                     | $%^&*
 1970-01-01 11:45:51 |       | t    | g029012                      | 
 1970-01-01 03:27:11 |       | f    | +!2-3-12030_!@#!)~_#@%)      | 
 1970-01-01 00:01:39 |       | t    | g029012                      | 
(10 rows)

--Testcase 95:
select (sctbl9.fields->>'sig4')::boolean sig4, (sctbl4.tags->>'sid5')::boolean sid5, (sctbl4.tags->>'sid6')::boolean sid6, sctbl4.tags->>'sid7' sid7, sctbl4.tags->>'sid8' sid8, sctbl4.tags->>'sid9' sid9 from sctbl4 LEFT OUTER JOIN sctbl9 ON ((sctbl4.fields->>'sig1')::bigint = (sctbl9.fields->>'sig1')::bigint OR (sctbl4.fields->>'sig3')::double precision> (sctbl9.fields->>'sig3')::double precision) GROUP BY (sctbl4.fields->>'sig1')::bigint,(sctbl9.fields->>'sig3')::double precision,(sctbl9.fields->>'sig4')::boolean,(sctbl4.tags->>'sid5')::boolean,(sctbl4.tags->>'sid6')::boolean,sctbl4.tags->>'sid7',sctbl4.tags->>'sid8',sctbl4.tags->>'sid9' HAVING (sctbl4.fields->>'sig1')::bigint > sum((sctbl9.fields->>'sig3')::double precision) ORDER BY sid7, sid8, sid9 LIMIT 20 OFFSET 0;
 sig4 | sid5 | sid6 |    sid7    |   sid8   |         sid9         
------+------+------+------------+----------+----------------------
 t    | t    | f    | attract    | $%^&*    | 辛辣仇恨挫败悲观情绪
 t    | t    | f    | average    | &^%&^%$# | 悲观失望希望美丽
 f    | t    | f    | average    | &^%&^%$# | 悲观失望希望美丽
 f    | t    | f    | average    | &^%&^%$# | 悲观失望希望美丽
 t    | t    | f    | average    | &^%&^%$# | 悲观失望希望美丽
 f    | t    | f    | average    | &^%&^%$# | 悲观失望希望美丽
 t    | f    | t    | constraint | !@#$%^   | 讨厌生活
 f    | f    | t    | constraint | !@#$%^   | 讨厌生活
 t    |      |      |            |          | 
 f    |      |      |            |          | 
 f    |      |      |            |          | 
 t    |      |      |            |          | 
 f    |      |      |            |          | 
 f    |      |      |            |          | 
 t    |      |      |            |          | 
 f    |      |      |            |          | 
 f    |      |      |            |          | 
 t    |      |      |            |          | 
 f    |      |      |            |          | 
 f    |      |      |            |          | 
(20 rows)

--Testcase 96:
select (sctbl9.fields->>'sig4')::boolean sig4, sctbl9.fields->>'sig2' sig2, (sctbl4.tags->>'sid3')::bigint sid3, (sctbl4.tags->>'sid5')::boolean sid5, sctbl4.tags->>'sid7' sid7, sctbl4.tags->>'sid9' sid9, sctbl4.tags->>'sid16' sid16 from sctbl4 LEFT OUTER JOIN sctbl9 ON ((sctbl4.fields->>'sig3')::double precision > (sctbl9.fields->>'sig3')::double precision AND sctbl9.tags->>'sname' LIKE 'rapviet') GROUP BY (sctbl9.fields->>'sig4')::boolean,sctbl9.fields->>'sig2',(sctbl4.tags->>'sid3')::bigint,(sctbl4.tags->>'sid5')::boolean,sctbl4.tags->>'sid7',sctbl4.tags->>'sid9',sctbl4.tags->>'sid16',(sctbl4.fields->>'sig1')::bigint,sctbl9.tags->>'sname' ORDER BY (sctbl4.fields->>'sig1')::bigint DESC, sctbl9.tags->>'sname' LIMIT 10 OFFSET 8;
 sig4 |               sig2               | sid3 | sid5 |    sid7    |       sid9       | sid16 
------+----------------------------------+------+------+------------+------------------+-------
 t    | XINChaoTOIyeUcaCbaN              |      |      |            |                  | 
 t    | 制御装置が正常に稼働していません |      |      |            |                  | 
      |                                  |      |      |            |                  | 
 f    | C)@ma EFJAe=3kake                |      |      |            |                  | 
 f    | 設計検討資料                     |      |      |            |                  | 
 t    | XINChaoTOIyeUcaCbaN              |      |      |            |                  | 
 t    | 制御装置が正常に稼働していません | 3646 | f    | constraint | 讨厌生活         | id2
 t    | 制御装置が正常に稼働していません |      |      |            |                  | 
 f    | C)@ma EFJAe=3kake                | 7663 | t    | average    | 悲观失望希望美丽 | id1
 f    | C)@ma EFJAe=3kake                |      |      |            |                  | 
(10 rows)

--Testcase 97:
select (sctbl4.tags->>'sid3')::bigint sid3, (sctbl4.tags->>'sid5')::boolean sid5, sctbl4.tags->>'sid7' sid7, sctbl4.tags->>'sid9' sid9, sctbl4.tags->>'sid16' sid16 from sctbl4 RIGHT OUTER JOIN sctbl9 ON (sctbl4.fields->>'sig4')::boolean = (sctbl9.fields->>'sig4')::boolean LIMIT 17 OFFSET 2;
 sid3 | sid5 |    sid7     |         sid9         | sid16 
------+------+-------------+----------------------+-------
      |      |             |                      | 
      |      |             |                      | 
      |      |             |                      | 
      |      |             |                      | 
 8578 | t    | attract     | 辛辣仇恨挫败悲观情绪 | id1
 4366 | f    | cooperation | 生活无聊             | id4
      |      |             |                      | 
      |      |             |                      | 
      |      |             |                      | 
      |      |             |                      | 
      |      |             |                      | 
      |      |             |                      | 
      |      |             |                      | 
      |      |             |                      | 
      |      |             |                      | 
      |      |             |                      | 
      |      |             |                      | 
(17 rows)

--Testcase 98:
select sctbl4.tags->>'sid4' sid4, sctbl9.tags->>'sname' sname, sctbl4.tags->>'sid8' sid8, (sctbl4.tags->>'sid12')::bigint sid12, sctbl4.tags->>'sid14' sid14, (sctbl4.tags->>'sid20')::bigint sid20 from sctbl4 RIGHT OUTER JOIN sctbl9 ON ((sctbl4.fields->>'sig1')::bigint = (sctbl9.fields->>'sig3')::double precision OR (sctbl4.fields->>'sig3')::double precision > (sctbl9.fields->>'sig3')::double precision) GROUP BY (sctbl4.fields->>'sig1')::bigint,(sctbl9.fields->>'sig3')::double precision,sctbl4.tags->>'sid4',sctbl9.tags->>'sname',sctbl4.tags->>'sid8',(sctbl4.tags->>'sid12')::bigint,sctbl4.tags->>'sid14',(sctbl4.tags->>'sid20')::bigint HAVING (sctbl4.fields->>'sig1')::bigint < avg((sctbl9.fields->>'sig3')::double precision) ORDER BY sid12, sid20 LIMIT 9 OFFSET 1;
       sid4       |   sname   |  sid8   |    sid12     | sid14 |  sid20   
------------------+-----------+---------+--------------+-------+----------
 epzhtqukYCyZNZbI | kingofrap | $%^&*   |  10781647619 | id3   |    31246
 SOlGbhjGOauCvZrK | rapviet   | @&*$%^& | 361645187500 | id4   | 12315475
 SOlGbhjGOauCvZrK | kingofrap | @&*$%^& | 361645187500 | id4   | 12315475
 SOlGbhjGOauCvZrK | rapviet   | @&*$%^& | 361645187500 | id4   | 12315475
                  | rapviet   |         |              |       |         
                  | kingofrap |         |              |       |         
                  | rapviet   |         |              |       |         
                  | kingofrap |         |              |       |         
                  | kingofrap |         |              |       |         
(9 rows)

--Testcase 99:
select (sctbl4.tags->>'sid3')::bigint sid3, (sctbl4.tags->>'sid5')::boolean sid5, sctbl4.tags->>'sid7' sid7, sctbl4.tags->>'sid' sid, sctbl9.tags->>'sid' sid from sctbl4 FULL OUTER JOIN sctbl9 ON (sctbl4.fields->>'sig1')::bigint = (sctbl9.fields->>'sig1')::bigint GROUP BY (sctbl4.tags->>'sid3')::bigint,(sctbl4.tags->>'sid5')::boolean,sctbl4.tags->>'sid7',sctbl4.tags->>'sid',sctbl9.tags->>'sid';
 sid3 | sid5 |    sid7     | sid | sid 
------+------+-------------+-----+-----
      |      |             | id2 | id2
      |      |             |     | id8
      |      |             |     | id1
   38 | f    | freighter   |     | id3
      |      |             | id2 | id7
      |      |             |     | id6
      |      |             | id1 | id5
      |      |             | id4 | id4
      |      |             |     | id4
      |      |             | id1 | id1
      |      |             | id1 | id9
      |      |             |     | id7
 4366 | f    | cooperation |     | id4
      |      |             |     | id5
      |      |             |     | id9
 8578 | t    | attract     |     | id1
      |      |             | id3 | id6
 7663 | t    | average     |     | id5
      |      |             | id4 | id8
      |      |             |     | id2
      |      |             |     | id3
 3646 | f    | constraint  |     | id2
      |      |             | id3 | id3
(23 rows)

--Testcase 100:
select sctbl4.tags->>'sid' sid, sctbl9.tags->>'sid' sid, (sctbl4.tags->>'sid3')::bigint sid3, sctbl4.tags->>'sid16' sid16, sctbl4.tags->>'sid18' sid18, (sctbl4.fields->>'sig4')::boolean sig4 from sctbl4 FULL OUTER JOIN sctbl9 ON (sctbl4.fields->>'sig3')::double precision < (sctbl9.fields->>'sig3')::double precision WHERE (sctbl4.fields->>'sig1')::bigint > 0 AND (sctbl9.fields->>'sig3')::double precision != 1 AND sctbl9.tags->>'sname' LIKE 'kingofrap' OR (sctbl9.fields->>'sig1')::bigint = -9999 GROUP BY sctbl4.tags->>'sid',sctbl9.tags->>'sid',sctbl4.tags->>'sid3',sctbl4.tags->>'sid16',sctbl4.tags->>'sid18',sctbl4.fields->>'sig4';
 sid | sid | sid3 | sid16 | sid18 | sig4 
-----+-----+------+-------+-------+------
 id1 | id2 |      |       |       | f
 id1 | id4 |      |       |       | f
 id1 | id5 |      |       |       | f
 id1 | id8 |      |       |       | f
 id1 | id9 |      |       |       | f
 id3 | id2 |      |       |       | f
 id3 | id4 |      |       |       | f
 id3 | id5 |      |       |       | f
 id3 | id8 |      |       |       | f
 id3 | id9 |      |       |       | f
     | id2 | 8578 | id1   | id1   | t
     | id2 |      |       |       | t
     | id4 | 3646 | id2   | id2   | f
     | id4 | 8578 | id1   | id1   | t
     | id4 |      |       |       | t
     | id5 | 3646 | id2   | id2   | f
     | id5 | 8578 | id1   | id1   | t
     | id5 |      |       |       | t
     | id8 | 3646 | id2   | id2   | f
     | id8 | 7663 | id1   | id1   | f
     | id8 | 8578 | id1   | id1   | t
     | id8 |      |       |       | t
     | id9 | 3646 | id2   | id2   | f
     | id9 | 7663 | id1   | id1   | f
     | id9 | 8578 | id1   | id1   | t
     | id9 |      |       |       | t
(26 rows)

--Testcase 101:
select * from sctbl4 CROSS JOIN sctbl9 ORDER BY sctbl4.tags->>'sid1',(sctbl4.tags->>'sid2')::bigint,(sctbl4.tags->>'sid3')::bigint,sctbl4.tags->>'sid4',sctbl4.tags->>'sid5',sctbl4.tags->>'sid6',sctbl4.tags->>'sid7',sctbl4.tags->>'sid8',sctbl4.tags->>'sid9',sctbl4.tags->>'sid10',(sctbl9.fields->>'sig1')::bigint,sctbl9.fields->>'sig2',(sctbl9.fields->>'sig3')::double precision,sctbl9.fields->>'sig4' LIMIT 10 OFFSET 0;
                                                                                                                                                                                                                                      tags                                                                                                                                                                                                                                      |                                    fields                                     |        time         |                 tags                 |                                            fields                                             |        time         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------+--------------------------------------+-----------------------------------------------------------------------------------------------+---------------------
 {"sid": null, "sid1": "1wBi4XmD6vOCRM7", "sid2": "2462190", "sid3": "4366", "sid4": "SOlGbhjGOauCvZrK", "sid5": "FALSE", "sid6": "true", "sid7": "cooperation", "sid8": "@&*$%^&", "sid9": "生活无聊", "sid10": "\"1 chồng 2 ck \"", "sid11": "f", "sid12": "361645187500", "sid13": "178617.7", "sid14": "id4", "sid15": "false", "sid16": "id4", "sid17": "黎明起床是为了鸟", "sid18": "id4", "sid19": "彼はなぜ18歳で彼がHHJAHJGYJB", "sid20": "12315475"}                  | {"sig1": "-340", "sig2": "装置開発機能仕", "sig3": "20.4", "sig4": "true"}    | 1970-04-11 10:42:54 | {"sid": "id4", "sname": "kingofrap"} | {"sig1": "-340", "sig2": "装置開111発機能仕", "sig3": "20.4", "sig4": "true"}                 | 1970-01-01 00:00:01
 {"sid": null, "sid1": "1wBi4XmD6vOCRM7", "sid2": "2462190", "sid3": "4366", "sid4": "SOlGbhjGOauCvZrK", "sid5": "FALSE", "sid6": "true", "sid7": "cooperation", "sid8": "@&*$%^&", "sid9": "生活无聊", "sid10": "\"1 chồng 2 ck \"", "sid11": "f", "sid12": "361645187500", "sid13": "178617.7", "sid14": "id4", "sid15": "false", "sid16": "id4", "sid17": "黎明起床是为了鸟", "sid18": "id4", "sid19": "彼はなぜ18歳で彼がHHJAHJGYJB", "sid20": "12315475"}                  | {"sig1": "-340", "sig2": "装置開発機能仕", "sig3": "20.4", "sig4": "true"}    | 1970-04-11 10:42:54 | {"sid": "id3", "sname": "rapviet"}   | {"sig1": "-230", "sig2": "C)@ma EFJAe=3kake", "sig3": "10.3", "sig4": "false"}                | 1970-01-01 00:00:00
 {"sid": null, "sid1": "1wBi4XmD6vOCRM7", "sid2": "2462190", "sid3": "4366", "sid4": "SOlGbhjGOauCvZrK", "sid5": "FALSE", "sid6": "true", "sid7": "cooperation", "sid8": "@&*$%^&", "sid9": "生活无聊", "sid10": "\"1 chồng 2 ck \"", "sid11": "f", "sid12": "361645187500", "sid13": "178617.7", "sid14": "id4", "sid15": "false", "sid16": "id4", "sid17": "黎明起床是为了鸟", "sid18": "id4", "sid19": "彼はなぜ18歳で彼がHHJAHJGYJB", "sid20": "12315475"}                  | {"sig1": "-340", "sig2": "装置開発機能仕", "sig3": "20.4", "sig4": "true"}    | 1970-04-11 10:42:54 | {"sid": "id9", "sname": "kingofrap"} | {"sig1": "190", "sig2": "0113 113'JXJOo02", "sig3": "30.9", "sig4": "false"}                  | 1970-01-01 00:00:02
 {"sid": null, "sid1": "1wBi4XmD6vOCRM7", "sid2": "2462190", "sid3": "4366", "sid4": "SOlGbhjGOauCvZrK", "sid5": "FALSE", "sid6": "true", "sid7": "cooperation", "sid8": "@&*$%^&", "sid9": "生活无聊", "sid10": "\"1 chồng 2 ck \"", "sid11": "f", "sid12": "361645187500", "sid13": "178617.7", "sid14": "id4", "sid15": "false", "sid16": "id4", "sid17": "黎明起床是为了鸟", "sid18": "id4", "sid19": "彼はなぜ18歳で彼がHHJAHJGYJB", "sid20": "12315475"}                  | {"sig1": "-340", "sig2": "装置開発機能仕", "sig3": "20.4", "sig4": "true"}    | 1970-04-11 10:42:54 | {"sid": "id7", "sname": "rapviet"}   | {"sig1": "370", "sig2": "XINChaoTOIyeUcaCbaN", "sig3": "30.7", "sig4": "true"}                | 1970-01-01 00:00:02
 {"sid": null, "sid1": "1wBi4XmD6vOCRM7", "sid2": "2462190", "sid3": "4366", "sid4": "SOlGbhjGOauCvZrK", "sid5": "FALSE", "sid6": "true", "sid7": "cooperation", "sid8": "@&*$%^&", "sid9": "生活无聊", "sid10": "\"1 chồng 2 ck \"", "sid11": "f", "sid12": "361645187500", "sid13": "178617.7", "sid14": "id4", "sid15": "false", "sid16": "id4", "sid17": "黎明起床是为了鸟", "sid18": "id4", "sid19": "彼はなぜ18歳で彼がHHJAHJGYJB", "sid20": "12315475"}                  | {"sig1": "-340", "sig2": "装置開発機能仕", "sig3": "20.4", "sig4": "true"}    | 1970-04-11 10:42:54 | {"sid": "id8", "sname": "kingofrap"} | {"sig1": "480", "sig2": "+!2-3-12030_!@#!)~_#@%)", "sig3": "30.8", "sig4": "false"}           | 1970-01-01 00:00:02
 {"sid": null, "sid1": "1wBi4XmD6vOCRM7", "sid2": "2462190", "sid3": "4366", "sid4": "SOlGbhjGOauCvZrK", "sid5": "FALSE", "sid6": "true", "sid7": "cooperation", "sid8": "@&*$%^&", "sid9": "生活无聊", "sid10": "\"1 chồng 2 ck \"", "sid11": "f", "sid12": "361645187500", "sid13": "178617.7", "sid14": "id4", "sid15": "false", "sid16": "id4", "sid17": "黎明起床是为了鸟", "sid18": "id4", "sid19": "彼はなぜ18歳で彼がHHJAHJGYJB", "sid20": "12315475"}                  | {"sig1": "-340", "sig2": "装置開発機能仕", "sig3": "20.4", "sig4": "true"}    | 1970-04-11 10:42:54 | {"sid": "id5", "sname": "kingofrap"} | {"sig1": "1250", "sig2": "システム", "sig3": "20.5", "sig4": "false"}                         | 1970-01-01 00:00:01
 {"sid": null, "sid1": "1wBi4XmD6vOCRM7", "sid2": "2462190", "sid3": "4366", "sid4": "SOlGbhjGOauCvZrK", "sid5": "FALSE", "sid6": "true", "sid7": "cooperation", "sid8": "@&*$%^&", "sid9": "生活无聊", "sid10": "\"1 chồng 2 ck \"", "sid11": "f", "sid12": "361645187500", "sid13": "178617.7", "sid14": "id4", "sid15": "false", "sid16": "id4", "sid17": "黎明起床是为了鸟", "sid18": "id4", "sid19": "彼はなぜ18歳で彼がHHJAHJGYJB", "sid20": "12315475"}                  | {"sig1": "-340", "sig2": "装置開発機能仕", "sig3": "20.4", "sig4": "true"}    | 1970-04-11 10:42:54 | {"sid": "id2", "sname": "kingofrap"} | {"sig1": "2120", "sig2": "BAEFOAWJ#AWEK", "sig3": "10.2", "sig4": "false"}                    | 1970-01-01 00:00:00
 {"sid": null, "sid1": "1wBi4XmD6vOCRM7", "sid2": "2462190", "sid3": "4366", "sid4": "SOlGbhjGOauCvZrK", "sid5": "FALSE", "sid6": "true", "sid7": "cooperation", "sid8": "@&*$%^&", "sid9": "生活无聊", "sid10": "\"1 chồng 2 ck \"", "sid11": "f", "sid12": "361645187500", "sid13": "178617.7", "sid14": "id4", "sid15": "false", "sid16": "id4", "sid17": "黎明起床是为了鸟", "sid18": "id4", "sid19": "彼はなぜ18歳で彼がHHJAHJGYJB", "sid20": "12315475"}                  | {"sig1": "-340", "sig2": "装置開発機能仕", "sig3": "20.4", "sig4": "true"}    | 1970-04-11 10:42:54 | {"sid": "id6", "sname": "rapviet"}   | {"sig1": "9260", "sig2": "設計検討資料", "sig3": "20.6", "sig4": "false"}                     | 1970-01-01 00:00:01
 {"sid": null, "sid1": "1wBi4XmD6vOCRM7", "sid2": "2462190", "sid3": "4366", "sid4": "SOlGbhjGOauCvZrK", "sid5": "FALSE", "sid6": "true", "sid7": "cooperation", "sid8": "@&*$%^&", "sid9": "生活无聊", "sid10": "\"1 chồng 2 ck \"", "sid11": "f", "sid12": "361645187500", "sid13": "178617.7", "sid14": "id4", "sid15": "false", "sid16": "id4", "sid17": "黎明起床是为了鸟", "sid18": "id4", "sid19": "彼はなぜ18歳で彼がHHJAHJGYJB", "sid20": "12315475"}                  | {"sig1": "-340", "sig2": "装置開発機能仕", "sig3": "20.4", "sig4": "true"}    | 1970-04-11 10:42:54 | {"sid": "id1", "sname": "rapviet"}   | {"sig1": "12120", "sig2": "制御装置が正常に稼働していません", "sig3": "10.1", "sig4": "true"} | 1970-01-01 00:00:00
 {"sid": null, "sid1": "3W9awb6DnWDGOGr", "sid2": "4830959", "sid3": "0038", "sid4": "epzhtqukYCyZNZbI", "sid5": "FALSE", "sid6": "true", "sid7": "freighter", "sid8": "$%^&*", "sid9": "爱情不幸福", "sid10": "\"4 vợ 5 vợ 6 v\"", "sid11": "f", "sid12": "10781647619", "sid13": "4988.9871", "sid14": "id3", "sid15": "false", "sid16": "id3", "sid17": "当他等待淋浴温暖时，他注意到他能听到水的变化温度", "sid18": "id3", "sid19": "彼はなぜ18歳で彼が", "sid20": "31246"} | {"sig1": "-230", "sig2": "C)@maEFJAe=3kake", "sig3": "10.3", "sig4": "false"} | 1970-01-08 08:36:26 | {"sid": "id4", "sname": "kingofrap"} | {"sig1": "-340", "sig2": "装置開111発機能仕", "sig3": "20.4", "sig4": "true"}                 | 1970-01-01 00:00:01
(10 rows)

--Testcase 102:
select sctbl4.tags->>'sid8' sid8, sctbl4.tags->>'sid9' sid9, (sctbl9.fields->>'sig1')::bigint sig1 from sctbl4 CROSS JOIN sctbl9 GROUP BY sctbl4.tags->>'sid8',sctbl4.tags->>'sid9',sctbl9.fields->>'sig1',sctbl4.fields->>'sig3',sctbl9.fields->>'sig1' HAVING (sctbl4.fields->>'sig3')::double precision >= sum((sctbl9.fields->>'sig1')::bigint) ORDER BY (sctbl9.fields->>'sig1')::bigint,(sctbl4.fields->>'sig3')::double precision LIMIT 10 OFFSET 0;
   sid8   |         sid9         | sig1 
----------+----------------------+------
          |                      | -340
          |                      | -340
          |                      | -340
 $%^&*    | 辛辣仇恨挫败悲观情绪 | -340
 !@#$%^   | 讨厌生活             | -340
 $%^&*    | 爱情不幸福           | -340
 @&*$%^&  | 生活无聊             | -340
 &^%&^%$# | 悲观失望希望美丽     | -340
          |                      | -340
          |                      | -340
(10 rows)

-- Clean
--Testcase 103:
DROP FOREIGN TABLE sctbl4;
--Testcase 104:
DROP FOREIGN TABLE sctbl9;
--Testcase 105:
DROP USER MAPPING FOR CURRENT_USER SERVER influxdb_svr;
--Testcase 106:
DROP SERVER influxdb_svr CASCADE;
--Testcase 107:
DROP EXTENSION influxdb_fdw;
